  
	
<style type="text/css">
p, li { white-space: pre-wrap; }
</style>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">应用程序在某一时刻，可能需要在数据库中存储"大"数据。</pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">"大"通常意味着"大约<span style=" color:#c0c0c0;"> </span>4kb<span style=" color:#c0c0c0;"> </span>或以上"，尽管某些数据库在数据达到"大"之前可以轻松地处理多达<span style=" color:#c0c0c0;"> </span>32kb<span style=" color:#c0c0c0;"> </span>的数据。大对象本质上可能是文本或二进制。</pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">在<span style=" color:#c0c0c0;"> </span>PDOStatement::bindParam()<span style=" color:#c0c0c0;"> </span>或<span style=" color:#c0c0c0;"> </span>PDOStatement::bindColumn())<span style=" color:#c0c0c0;"> </span>调用中使用<span style=" color:#c0c0c0;"> </span>PDO::PARAM_LOB<span style=" color:#c0c0c0;"> </span>类型码可以让<span style=" color:#c0c0c0;"> </span>PDO<span style=" color:#c0c0c0;"> </span>使用大数据类型。</pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">PDO::PARAM_LOB<span style=" color:#c0c0c0;"> </span>告诉<span style=" color:#c0c0c0;"> </span>PDO<span style=" color:#c0c0c0;"> </span>作为流来映射数据，以便能使用<span style=" color:#c0c0c0;"> </span>PHP<span style=" color:#c0c0c0;"> </span>Streams<span style=" color:#c0c0c0;"> </span>API<span style=" color:#c0c0c0;"> </span>来操作。</pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">从数据库中显示一张图片</pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">下面例子绑定一个<span style=" color:#c0c0c0;"> </span>LOB<span style=" color:#c0c0c0;"> </span>到<span style=" color:#c0c0c0;"> </span>$lob<span style=" color:#c0c0c0;"> </span>变量，然后用<span style=" color:#c0c0c0;"> </span>fpassthru()<span style=" color:#c0c0c0;"> </span>将其发送到浏览器。因为<span style=" color:#c0c0c0;"> </span>LOB<span style=" color:#c0c0c0;"> </span>代表一个流，所以类似<span style=" color:#c0c0c0;"> </span>fgets()、fread()<span style=" color:#c0c0c0;"> </span>以及<span style=" color:#c0c0c0;"> </span>stream_get_contents()<span style=" color:#c0c0c0;"> </span>这样的函数都可以用在它上面。</pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#000080;">&lt;?php</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">$db<span style=" color:#c0c0c0;"> </span>=<span style=" color:#c0c0c0;"> </span>new<span style=" color:#c0c0c0;"> </span>PDO('odbc:SAMPLE',<span style=" color:#c0c0c0;"> </span>'db2inst1',<span style=" color:#c0c0c0;"> </span>'ibmdb2');</pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">$stmt<span style=" color:#c0c0c0;"> </span>=<span style=" color:#c0c0c0;"> </span>$db-&gt;prepare("select<span style=" color:#c0c0c0;"> </span>contenttype,<span style=" color:#c0c0c0;"> </span>imagedata<span style=" color:#c0c0c0;"> </span>from<span style=" color:#c0c0c0;"> </span>images<span style=" color:#c0c0c0;"> </span>where<span style=" color:#c0c0c0;"> </span>id=?");</pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">$stmt-&gt;execute(array($_GET['id']));</pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">$stmt-&gt;bindColumn(1,<span style=" color:#c0c0c0;"> </span>$type,<span style=" color:#c0c0c0;"> </span>PDO::PARAM_STR,<span style=" color:#c0c0c0;"> </span>256);</pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">$stmt-&gt;bindColumn(2,<span style=" color:#c0c0c0;"> </span>$lob,<span style=" color:#c0c0c0;"> </span>PDO::PARAM_LOB);</pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">$stmt-&gt;fetch(PDO::FETCH_BOUND);</pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">header("Content-Type:<span style=" color:#c0c0c0;"> </span>$type");</pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">fpassthru($lob);</pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#000080;">?&gt;</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">插入一张图片到数据库</pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">下面例子打开一个文件并将文件句柄传给<span style=" color:#c0c0c0;"> </span>PDO<span style=" color:#c0c0c0;"> </span>来做为一个<span style=" color:#c0c0c0;"> </span>LOB<span style=" color:#c0c0c0;"> </span>插入。PDO尽可能地让数据库以最有效的方式获取文件内容。</pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#000080;">&lt;?php</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">$db<span style=" color:#c0c0c0;"> </span>=<span style=" color:#c0c0c0;"> </span>new<span style=" color:#c0c0c0;"> </span>PDO('odbc:SAMPLE',<span style=" color:#c0c0c0;"> </span>'db2inst1',<span style=" color:#c0c0c0;"> </span>'ibmdb2');</pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">$stmt<span style=" color:#c0c0c0;"> </span>=<span style=" color:#c0c0c0;"> </span>$db-&gt;prepare("insert<span style=" color:#c0c0c0;"> </span>into<span style=" color:#c0c0c0;"> </span>images<span style=" color:#c0c0c0;"> </span>(id,<span style=" color:#c0c0c0;"> </span>contenttype,<span style=" color:#c0c0c0;"> </span>imagedata)<span style=" color:#c0c0c0;"> </span>values<span style=" color:#c0c0c0;"> </span>(?,<span style=" color:#c0c0c0;"> </span>?,<span style=" color:#c0c0c0;"> </span>?)");</pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">$id<span style=" color:#c0c0c0;"> </span>=<span style=" color:#c0c0c0;"> </span>get_new_id();<span style=" color:#c0c0c0;"> </span>//<span style=" color:#c0c0c0;"> </span>调用某个函数来分配一个新<span style=" color:#c0c0c0;"> </span>ID</pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">//<span style=" color:#c0c0c0;"> </span>假设处理一个文件上传</pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">//<span style=" color:#c0c0c0;"> </span>可以在<span style=" color:#c0c0c0;"> </span>PHP<span style=" color:#c0c0c0;"> </span>文档中找到更多的信息</pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">$fp<span style=" color:#c0c0c0;"> </span>=<span style=" color:#c0c0c0;"> </span>fopen($_FILES['file']['tmp_name'],<span style=" color:#c0c0c0;"> </span>'rb');</pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">$stmt-&gt;bindParam(1,<span style=" color:#c0c0c0;"> </span>$id);</pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">$stmt-&gt;bindParam(2,<span style=" color:#c0c0c0;"> </span>$_FILES['file']['type']);</pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">$stmt-&gt;bindParam(3,<span style=" color:#c0c0c0;"> </span>$fp,<span style=" color:#c0c0c0;"> </span>PDO::PARAM_LOB);</pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">$db-&gt;beginTransaction();</pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">$stmt-&gt;execute();</pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">$db-&gt;commit();</pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#000080;">?&gt;</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">插入一张图片到数据库：Oracle</pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">对于从文件插入一个<span style=" color:#c0c0c0;"> </span>lob，Oracle略有不同。必须在事务之后进行插入，否则当执行查询时导致新近插入<span style=" color:#c0c0c0;"> </span>LOB<span style=" color:#c0c0c0;"> </span>将以0长度被隐式提交：</pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#000080;">&lt;?php</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">$db<span style=" color:#c0c0c0;"> </span>=<span style=" color:#c0c0c0;"> </span>new<span style=" color:#c0c0c0;"> </span>PDO('oci:',<span style=" color:#c0c0c0;"> </span>'scott',<span style=" color:#c0c0c0;"> </span>'tiger');</pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">$stmt<span style=" color:#c0c0c0;"> </span>=<span style=" color:#c0c0c0;"> </span>$db-&gt;prepare("insert<span style=" color:#c0c0c0;"> </span>into<span style=" color:#c0c0c0;"> </span>images<span style=" color:#c0c0c0;"> </span>(id,<span style=" color:#c0c0c0;"> </span>contenttype,<span style=" color:#c0c0c0;"> </span>imagedata)<span style=" color:#c0c0c0;"> </span>"<span style=" color:#c0c0c0;"> </span>.</pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">"VALUES<span style=" color:#c0c0c0;"> </span>(?,<span style=" color:#c0c0c0;"> </span>?,<span style=" color:#c0c0c0;"> </span>EMPTY_BLOB())<span style=" color:#c0c0c0;"> </span>RETURNING<span style=" color:#c0c0c0;"> </span>imagedata<span style=" color:#c0c0c0;"> </span>INTO<span style=" color:#c0c0c0;"> </span>?");</pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">$id<span style=" color:#c0c0c0;"> </span>=<span style=" color:#c0c0c0;"> </span>get_new_id();<span style=" color:#c0c0c0;"> </span>//<span style=" color:#c0c0c0;"> </span>调用某个函数来分配一个新<span style=" color:#c0c0c0;"> </span>ID</pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">//<span style=" color:#c0c0c0;"> </span>假设处理一个文件上传</pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">//<span style=" color:#c0c0c0;"> </span>可以在<span style=" color:#c0c0c0;"> </span>PHP<span style=" color:#c0c0c0;"> </span>文档中找到更多的信息</pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">$fp<span style=" color:#c0c0c0;"> </span>=<span style=" color:#c0c0c0;"> </span>fopen($_FILES['file']['tmp_name'],<span style=" color:#c0c0c0;"> </span>'rb');</pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">$stmt-&gt;bindParam(1,<span style=" color:#c0c0c0;"> </span>$id);</pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">$stmt-&gt;bindParam(2,<span style=" color:#c0c0c0;"> </span>$_FILES['file']['type']);</pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">$stmt-&gt;bindParam(3,<span style=" color:#c0c0c0;"> </span>$fp,<span style=" color:#c0c0c0;"> </span>PDO::PARAM_LOB);</pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">$stmt-&gt;beginTransaction();</pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">$stmt-&gt;execute();</pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">$stmt-&gt;commit();</pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#000080;">?&gt;</span></pre>