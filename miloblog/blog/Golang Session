  
	<br><pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#000080;">package</span><span style=" color:#c0c0c0;"> </span>gocs
</pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#000080;">import</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">(</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=" color:#008000;">"crypto/md5"</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=" color:#008000;">"errors"</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=" color:#008000;">"fmt"</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=" color:#008000;">"io"</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=" color:#008000;">"math/rand"</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=" color:#008000;">"net/http"</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=" color:#008000;">"strconv"</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=" color:#008000;">"sync"</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=" color:#008000;">"time"</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#000000;">)</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#000080;">type</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000080;">CookieSession</span><span style=" color:#c0c0c0;"> </span><span style=" font-weight:600; color:#000080;">struct</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">{</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;</span>cookieName<span style=" color:#c0c0c0;">  </span><span style=" color:#000080;">string</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;</span>lock<span style=" color:#c0c0c0;">        </span>sync<span style=" color:#000000;">.</span>RWMutex</pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;</span>maxLifeTime<span style=" color:#c0c0c0;"> </span><span style=" color:#000080;">int64</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;</span>sessions<span style=" color:#c0c0c0;">    </span><span style=" font-weight:600; color:#000080;">map</span><span style=" color:#000000;">[</span><span style=" color:#000080;">string</span><span style=" color:#000000;">]*</span>Session</pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#000000;">}</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#000080;">type</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000080;">Session</span><span style=" color:#c0c0c0;"> </span><span style=" font-weight:600; color:#000080;">struct</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">{</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;</span>sessionID<span style=" color:#c0c0c0;">  </span><span style=" color:#000080;">string</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;</span>createTime<span style=" color:#c0c0c0;"> </span>time<span style=" color:#000000;">.</span>Time</pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;</span>values<span style=" color:#c0c0c0;">     </span><span style=" font-weight:600; color:#000080;">map</span><span style=" color:#000000;">[</span><span style=" font-weight:600; color:#000080;">interface</span><span style=" color:#000000;">{}]</span><span style=" font-weight:600; color:#000080;">interface</span><span style=" color:#000000;">{}</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#000000;">}</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#000080;">var</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">(</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;</span>CookieName<span style=" color:#c0c0c0;"> </span><span style=" color:#000080;">string</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">=</span><span style=" color:#c0c0c0;"> </span><span style=" color:#008000;">"CookieName"</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;</span>MaxLT<span style=" color:#c0c0c0;">      </span><span style=" color:#000080;">int64</span><span style=" color:#c0c0c0;">  </span><span style=" color:#000000;">=</span><span style=" color:#c0c0c0;"> </span><span style=" color:#800080;">3600</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#000000;">)</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#000080;">func</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">NewCookieSession()</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">*</span>CookieSession<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">{</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;</span>cs<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">:=</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">&amp;</span>CookieSession<span style=" color:#000000;">{</span>cookieName<span style=" color:#000000;">:</span><span style=" color:#c0c0c0;"> </span>CookieName<span style=" color:#000000;">,</span><span style=" color:#c0c0c0;"> </span>maxLifeTime<span style=" color:#000000;">:</span><span style=" color:#c0c0c0;"> </span>MaxLT<span style=" color:#000000;">,</span><span style=" color:#c0c0c0;"> </span>sessions<span style=" color:#000000;">:</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000080;">make</span><span style=" color:#000000;">(</span><span style=" font-weight:600; color:#000080;">map</span><span style=" color:#000000;">[</span><span style=" color:#000080;">string</span><span style=" color:#000000;">]*</span>Session<span style=" color:#000000;">)}</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=" font-weight:600; color:#000080;">go</span><span style=" color:#c0c0c0;"> </span>cs<span style=" color:#000000;">.</span>GC<span style=" color:#000000;">()</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=" font-weight:600; color:#000080;">return</span><span style=" color:#c0c0c0;"> </span>cs</pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#000000;">}</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#000080;">func</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">(</span>cs<span style=" color:#c0c0c0;"> </span><span style=" color:#000080;">CookieSession</span><span style=" color:#000000;">)</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">GC()</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">{</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;</span>cs<span style=" color:#000000;">.</span>lock<span style=" color:#000000;">.</span>Lock<span style=" color:#000000;">()</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=" font-weight:600; color:#000080;">defer</span><span style=" color:#c0c0c0;"> </span>cs<span style=" color:#000000;">.</span>lock<span style=" color:#000000;">.</span>Unlock<span style=" color:#000000;">()</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=" font-weight:600; color:#000080;">for</span><span style=" color:#c0c0c0;"> </span>sessionID<span style=" color:#000000;">,</span><span style=" color:#c0c0c0;"> </span>session<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">:=</span><span style=" color:#c0c0c0;"> </span><span style=" font-weight:600; color:#000080;">range</span><span style=" color:#c0c0c0;"> </span>cs<span style=" color:#000000;">.</span>sessions<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">{</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=" font-weight:600; color:#000080;">if</span><span style=" color:#c0c0c0;"> </span>session<span style=" color:#000000;">.</span>createTime<span style=" color:#000000;">.</span>Unix<span style=" color:#000000;">()+</span>cs<span style=" color:#000000;">.</span>maxLifeTime<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">==</span><span style=" color:#c0c0c0;"> </span>time<span style=" color:#000000;">.</span>Now<span style=" color:#000000;">().</span>Unix<span style=" color:#000000;">()</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">{</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=" color:#000080;">delete</span><span style=" color:#000000;">(</span>cs<span style=" color:#000000;">.</span>sessions<span style=" color:#000000;">,</span><span style=" color:#c0c0c0;"> </span>sessionID<span style=" color:#000000;">)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=" color:#000000;">}</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=" color:#000000;">}</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;</span>time<span style=" color:#000000;">.</span>AfterFunc<span style=" color:#000000;">(</span>time<span style=" color:#000000;">.</span>Duration<span style=" color:#000000;">(</span>cs<span style=" color:#000000;">.</span>maxLifeTime<span style=" color:#000000;">)*</span>time<span style=" color:#000000;">.</span>Second<span style=" color:#000000;">,</span><span style=" color:#c0c0c0;"> </span><span style=" font-weight:600; color:#000080;">func</span><span style=" color:#000000;">()</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">{</span><span style=" color:#c0c0c0;"> </span>cs<span style=" color:#000000;">.</span>GC<span style=" color:#000000;">()</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">})</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#000000;">}</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#000080;">func</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">(</span>cs<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">*</span><span style=" color:#000080;">CookieSession</span><span style=" color:#000000;">)</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">StartSession(</span>w<span style=" color:#c0c0c0;"> </span>http<span style=" color:#000000;">.</span>ResponseWriter<span style=" color:#000000;">,</span><span style=" color:#c0c0c0;"> </span>r<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">*</span>http<span style=" color:#000000;">.</span>Request<span style=" color:#000000;">)</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">(</span><span style=" color:#000080;">string</span><span style=" color:#000000;">,</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000080;">error</span><span style=" color:#000000;">)</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">{</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;</span>cs<span style=" color:#000000;">.</span>lock<span style=" color:#000000;">.</span>Lock<span style=" color:#000000;">()</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=" font-weight:600; color:#000080;">defer</span><span style=" color:#c0c0c0;"> </span>cs<span style=" color:#000000;">.</span>lock<span style=" color:#000000;">.</span>Unlock<span style=" color:#000000;">()</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=" font-weight:600; color:#000080;">var</span><span style=" color:#c0c0c0;"> </span>newsessionid<span style=" color:#c0c0c0;"> </span><span style=" color:#000080;">string</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">=</span><span style=" color:#c0c0c0;"> </span><span style=" color:#008000;">""</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;</span>ck<span style=" color:#000000;">,</span><span style=" color:#c0c0c0;"> </span>err<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">:=</span><span style=" color:#c0c0c0;"> </span>r<span style=" color:#000000;">.</span>Cookie<span style=" color:#000000;">(</span>cs<span style=" color:#000000;">.</span>cookieName<span style=" color:#000000;">)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=" font-weight:600; color:#000080;">if</span><span style=" color:#c0c0c0;"> </span>err<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">!=</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000080;">nil</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">{</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=" font-weight:600; color:#000080;">if</span><span style=" color:#c0c0c0;"> </span>err<span style=" color:#000000;">.</span>Error<span style=" color:#000000;">()</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">==</span><span style=" color:#c0c0c0;"> </span><span style=" color:#008000;">"http:</span><span style=" color:#c0c0c0;"> </span><span style=" color:#008000;">named</span><span style=" color:#c0c0c0;"> </span><span style=" color:#008000;">cookie</span><span style=" color:#c0c0c0;"> </span><span style=" color:#008000;">not</span><span style=" color:#c0c0c0;"> </span><span style=" color:#008000;">present"</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">{</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>newsessionid<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">=</span><span style=" color:#c0c0c0;"> </span>encode<span style=" color:#000000;">(</span>unique<span style=" color:#000000;">()</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">+</span><span style=" color:#c0c0c0;"> </span><span style=" color:#008000;">"mysession"</span><span style=" color:#000000;">)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=" font-weight:600; color:#000080;">var</span><span style=" color:#c0c0c0;"> </span>session<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">*</span>Session<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">=</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">&amp;</span>Session<span style=" color:#000000;">{</span>sessionID<span style=" color:#000000;">:</span><span style=" color:#c0c0c0;"> </span>newsessionid<span style=" color:#000000;">,</span><span style=" color:#c0c0c0;"> </span>createTime<span style=" color:#000000;">:</span><span style=" color:#c0c0c0;"> </span>time<span style=" color:#000000;">.</span>Now<span style=" color:#000000;">(),</span><span style=" color:#c0c0c0;"> </span>values<span style=" color:#000000;">:</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000080;">make</span><span style=" color:#000000;">(</span><span style=" font-weight:600; color:#000080;">map</span><span style=" color:#000000;">[</span><span style=" font-weight:600; color:#000080;">interface</span><span style=" color:#000000;">{}]</span><span style=" font-weight:600; color:#000080;">interface</span><span style=" color:#000000;">{})}</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>cs<span style=" color:#000000;">.</span>sessions<span style=" color:#000000;">[</span>newsessionid<span style=" color:#000000;">]</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">=</span><span style=" color:#c0c0c0;"> </span>session</pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=" color:#000000;">}</span><span style=" color:#c0c0c0;"> </span><span style=" font-weight:600; color:#000080;">else</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">{</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=" font-weight:600; color:#000080;">return</span><span style=" color:#c0c0c0;"> </span>newsessionid<span style=" color:#000000;">,</span><span style=" color:#c0c0c0;"> </span>err</pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=" color:#000000;">}</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=" color:#000000;">}</span><span style=" color:#c0c0c0;"> </span><span style=" font-weight:600; color:#000080;">else</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">{</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>sessionid<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">:=</span><span style=" color:#c0c0c0;"> </span>ck<span style=" color:#000000;">.</span>Value</pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=" font-weight:600; color:#000080;">if</span><span style=" color:#c0c0c0;"> </span>_<span style=" color:#000000;">,</span><span style=" color:#c0c0c0;"> </span>ok<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">:=</span><span style=" color:#c0c0c0;"> </span>cs<span style=" color:#000000;">.</span>sessions<span style=" color:#000000;">[</span>sessionid<span style=" color:#000000;">];</span><span style=" color:#c0c0c0;"> </span>ok<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">{</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>newsessionid<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">=</span><span style=" color:#c0c0c0;"> </span>ck<span style=" color:#000000;">.</span>Value</pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=" color:#000000;">}</span><span style=" color:#c0c0c0;"> </span><span style=" font-weight:600; color:#000080;">else</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">{</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>newsessionid<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">=</span><span style=" color:#c0c0c0;"> </span>encode<span style=" color:#000000;">(</span>unique<span style=" color:#000000;">()</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">+</span><span style=" color:#c0c0c0;"> </span><span style=" color:#008000;">"mysession"</span><span style=" color:#000000;">)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=" font-weight:600; color:#000080;">var</span><span style=" color:#c0c0c0;"> </span>session<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">*</span>Session<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">=</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">&amp;</span>Session<span style=" color:#000000;">{</span>sessionID<span style=" color:#000000;">:</span><span style=" color:#c0c0c0;"> </span>newsessionid<span style=" color:#000000;">,</span><span style=" color:#c0c0c0;"> </span>createTime<span style=" color:#000000;">:</span><span style=" color:#c0c0c0;"> </span>time<span style=" color:#000000;">.</span>Now<span style=" color:#000000;">(),</span><span style=" color:#c0c0c0;"> </span>values<span style=" color:#000000;">:</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000080;">make</span><span style=" color:#000000;">(</span><span style=" font-weight:600; color:#000080;">map</span><span style=" color:#000000;">[</span><span style=" font-weight:600; color:#000080;">interface</span><span style=" color:#000000;">{}]</span><span style=" font-weight:600; color:#000080;">interface</span><span style=" color:#000000;">{})}</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>cs<span style=" color:#000000;">.</span>sessions<span style=" color:#000000;">[</span>newsessionid<span style=" color:#000000;">]</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">=</span><span style=" color:#c0c0c0;"> </span>session</pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=" color:#000000;">}</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=" color:#000000;">}</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;</span>cookie<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">:=</span><span style=" color:#c0c0c0;"> </span>http<span style=" color:#000000;">.</span>Cookie<span style=" color:#000000;">{</span>Name<span style=" color:#000000;">:</span><span style=" color:#c0c0c0;"> </span>cs<span style=" color:#000000;">.</span>cookieName<span style=" color:#000000;">,</span><span style=" color:#c0c0c0;"> </span>Value<span style=" color:#000000;">:</span><span style=" color:#c0c0c0;"> </span>newsessionid<span style=" color:#000000;">,</span><span style=" color:#c0c0c0;"> </span>Path<span style=" color:#000000;">:</span><span style=" color:#c0c0c0;"> </span><span style=" color:#008000;">"/"</span><span style=" color:#000000;">,</span><span style=" color:#c0c0c0;"> </span>HttpOnly<span style=" color:#000000;">:</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000080;">true</span><span style=" color:#000000;">,</span><span style=" color:#c0c0c0;"> </span>MaxAge<span style=" color:#000000;">:</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000080;">int</span><span style=" color:#000000;">(</span>cs<span style=" color:#000000;">.</span>maxLifeTime<span style=" color:#000000;">)}</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;</span>http<span style=" color:#000000;">.</span>SetCookie<span style=" color:#000000;">(</span>w<span style=" color:#000000;">,</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">&amp;</span>cookie<span style=" color:#000000;">)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=" font-weight:600; color:#000080;">return</span><span style=" color:#c0c0c0;"> </span>newsessionid<span style=" color:#000000;">,</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000080;">nil</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#000000;">}</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#000080;">func</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">(</span>cs<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">*</span><span style=" color:#000080;">CookieSession</span><span style=" color:#000000;">)</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">GetSessionID(</span>w<span style=" color:#c0c0c0;"> </span>http<span style=" color:#000000;">.</span>ResponseWriter<span style=" color:#000000;">,</span><span style=" color:#c0c0c0;"> </span>r<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">*</span>http<span style=" color:#000000;">.</span>Request<span style=" color:#000000;">)</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">(</span><span style=" color:#000080;">string</span><span style=" color:#000000;">,</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000080;">error</span><span style=" color:#000000;">)</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">{</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;</span>cs<span style=" color:#000000;">.</span>lock<span style=" color:#000000;">.</span>Lock<span style=" color:#000000;">()</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;</span>cs<span style=" color:#000000;">.</span>lock<span style=" color:#000000;">.</span>Unlock<span style=" color:#000000;">()</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=" font-weight:600; color:#000080;">var</span><span style=" color:#c0c0c0;"> </span>sessionid<span style=" color:#c0c0c0;"> </span><span style=" color:#000080;">string</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">=</span><span style=" color:#c0c0c0;"> </span><span style=" color:#008000;">""</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;</span>ck<span style=" color:#000000;">,</span><span style=" color:#c0c0c0;"> </span>err<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">:=</span><span style=" color:#c0c0c0;"> </span>r<span style=" color:#000000;">.</span>Cookie<span style=" color:#000000;">(</span>cs<span style=" color:#000000;">.</span>cookieName<span style=" color:#000000;">)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=" font-weight:600; color:#000080;">if</span><span style=" color:#c0c0c0;"> </span>err<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">!=</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000080;">nil</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">{</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=" font-weight:600; color:#000080;">return</span><span style=" color:#c0c0c0;"> </span><span style=" color:#008000;">""</span><span style=" color:#000000;">,</span><span style=" color:#c0c0c0;"> </span>err</pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=" color:#000000;">}</span><span style=" color:#c0c0c0;"> </span><span style=" font-weight:600; color:#000080;">else</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">{</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>sessionid<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">=</span><span style=" color:#c0c0c0;"> </span>ck<span style=" color:#000000;">.</span>Value</pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=" font-weight:600; color:#000080;">if</span><span style=" color:#c0c0c0;"> </span>_<span style=" color:#000000;">,</span><span style=" color:#c0c0c0;"> </span>ok<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">:=</span><span style=" color:#c0c0c0;"> </span>cs<span style=" color:#000000;">.</span>sessions<span style=" color:#000000;">[</span>sessionid<span style=" color:#000000;">];</span><span style=" color:#c0c0c0;"> </span>ok<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">{</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=" font-weight:600; color:#000080;">return</span><span style=" color:#c0c0c0;"> </span>sessionid<span style=" color:#000000;">,</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000080;">nil</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=" color:#000000;">}</span><span style=" color:#c0c0c0;"> </span><span style=" font-weight:600; color:#000080;">else</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">{</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>e<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">:=</span><span style=" color:#c0c0c0;"> </span>errors<span style=" color:#000000;">.</span>New<span style=" color:#000000;">(</span><span style=" color:#008000;">"客户端伪造了cookie</span><span style=" color:#c0c0c0;"> </span><span style=" color:#008000;">value"</span><span style=" color:#000000;">)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=" font-weight:600; color:#000080;">return</span><span style=" color:#c0c0c0;"> </span><span style=" color:#008000;">""</span><span style=" color:#000000;">,</span><span style=" color:#c0c0c0;"> </span>e</pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=" color:#000000;">}</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=" color:#000000;">}</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#000000;">}</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#000080;">func</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">(</span>cs<span style=" color:#c0c0c0;"> </span><span style=" color:#000080;">CookieSession</span><span style=" color:#000000;">)</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">SetSession(</span>sessionID<span style=" color:#c0c0c0;"> </span><span style=" color:#000080;">string</span><span style=" color:#000000;">,</span><span style=" color:#c0c0c0;"> </span>key<span style=" color:#c0c0c0;"> </span><span style=" font-weight:600; color:#000080;">interface</span><span style=" color:#000000;">{},</span><span style=" color:#c0c0c0;"> </span>value<span style=" color:#c0c0c0;"> </span><span style=" font-weight:600; color:#000080;">interface</span><span style=" color:#000000;">{})</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000080;">error</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">{</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;</span>cs<span style=" color:#000000;">.</span>lock<span style=" color:#000000;">.</span>Lock<span style=" color:#000000;">()</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=" font-weight:600; color:#000080;">defer</span><span style=" color:#c0c0c0;"> </span>cs<span style=" color:#000000;">.</span>lock<span style=" color:#000000;">.</span>Unlock<span style=" color:#000000;">()</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=" font-weight:600; color:#000080;">if</span><span style=" color:#c0c0c0;"> </span>session<span style=" color:#000000;">,</span><span style=" color:#c0c0c0;"> </span>ok<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">:=</span><span style=" color:#c0c0c0;"> </span>cs<span style=" color:#000000;">.</span>sessions<span style=" color:#000000;">[</span>sessionID<span style=" color:#000000;">];</span><span style=" color:#c0c0c0;"> </span>ok<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">{</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>session<span style=" color:#000000;">.</span>values<span style=" color:#000000;">[</span>key<span style=" color:#000000;">]</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">=</span><span style=" color:#c0c0c0;"> </span>value</pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=" color:#000000;">}</span><span style=" color:#c0c0c0;"> </span><span style=" font-weight:600; color:#000080;">else</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">{</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>err<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">:=</span><span style=" color:#c0c0c0;"> </span>errors<span style=" color:#000000;">.</span>New<span style=" color:#000000;">(</span><span style=" color:#008000;">"sessionID不存在"</span><span style=" color:#000000;">)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=" font-weight:600; color:#000080;">return</span><span style=" color:#c0c0c0;"> </span>err</pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=" color:#000000;">}</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=" font-weight:600; color:#000080;">return</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000080;">nil</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#000000;">}</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#000080;">func</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">(</span>cs<span style=" color:#c0c0c0;"> </span><span style=" color:#000080;">CookieSession</span><span style=" color:#000000;">)</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">GetSessions()</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">[]</span><span style=" color:#000080;">string</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">{</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;</span>cs<span style=" color:#000000;">.</span>lock<span style=" color:#000000;">.</span>Lock<span style=" color:#000000;">()</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=" font-weight:600; color:#000080;">defer</span><span style=" color:#c0c0c0;"> </span>cs<span style=" color:#000000;">.</span>lock<span style=" color:#000000;">.</span>Unlock<span style=" color:#000000;">()</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;</span>sessions<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">:=</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000080;">make</span><span style=" color:#000000;">([]</span><span style=" color:#000080;">string</span><span style=" color:#000000;">,</span><span style=" color:#c0c0c0;"> </span><span style=" color:#800080;">0</span><span style=" color:#000000;">)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=" font-weight:600; color:#000080;">for</span><span style=" color:#c0c0c0;"> </span>k<span style=" color:#000000;">,</span><span style=" color:#c0c0c0;"> </span>_<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">:=</span><span style=" color:#c0c0c0;"> </span><span style=" font-weight:600; color:#000080;">range</span><span style=" color:#c0c0c0;"> </span>cs<span style=" color:#000000;">.</span>sessions<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">{</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>sessions<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">=</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000080;">append</span><span style=" color:#000000;">(</span>sessions<span style=" color:#000000;">,</span><span style=" color:#c0c0c0;"> </span>k<span style=" color:#000000;">)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=" color:#000000;">}</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=" font-weight:600; color:#000080;">return</span><span style=" color:#c0c0c0;"> </span>sessions</pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#000000;">}</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#000080;">func</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">(</span>cs<span style=" color:#c0c0c0;"> </span><span style=" color:#000080;">CookieSession</span><span style=" color:#000000;">)</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">GetSession(</span>sessionID<span style=" color:#c0c0c0;"> </span><span style=" color:#000080;">string</span><span style=" color:#000000;">,</span><span style=" color:#c0c0c0;"> </span>key<span style=" color:#c0c0c0;"> </span><span style=" font-weight:600; color:#000080;">interface</span><span style=" color:#000000;">{})</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">(</span><span style=" font-weight:600; color:#000080;">interface</span><span style=" color:#000000;">{},</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000080;">bool</span><span style=" color:#000000;">)</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">{</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;</span>cs<span style=" color:#000000;">.</span>lock<span style=" color:#000000;">.</span>Lock<span style=" color:#000000;">()</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=" font-weight:600; color:#000080;">defer</span><span style=" color:#c0c0c0;"> </span>cs<span style=" color:#000000;">.</span>lock<span style=" color:#000000;">.</span>Unlock<span style=" color:#000000;">()</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=" font-weight:600; color:#000080;">if</span><span style=" color:#c0c0c0;"> </span>session<span style=" color:#000000;">,</span><span style=" color:#c0c0c0;"> </span>ok<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">:=</span><span style=" color:#c0c0c0;"> </span>cs<span style=" color:#000000;">.</span>sessions<span style=" color:#000000;">[</span>sessionID<span style=" color:#000000;">];</span><span style=" color:#c0c0c0;"> </span>ok<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">{</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=" font-weight:600; color:#000080;">if</span><span style=" color:#c0c0c0;"> </span>value<span style=" color:#000000;">,</span><span style=" color:#c0c0c0;"> </span>ok<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">:=</span><span style=" color:#c0c0c0;"> </span>session<span style=" color:#000000;">.</span>values<span style=" color:#000000;">[</span>key<span style=" color:#000000;">];</span><span style=" color:#c0c0c0;"> </span>ok<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">{</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=" font-weight:600; color:#000080;">return</span><span style=" color:#c0c0c0;"> </span>value<span style=" color:#000000;">,</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000080;">true</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=" color:#000000;">}</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=" color:#000000;">}</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=" font-weight:600; color:#000080;">return</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000080;">nil</span><span style=" color:#000000;">,</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000080;">false</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#000000;">}</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#000080;">func</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">(</span>cs<span style=" color:#c0c0c0;"> </span><span style=" color:#000080;">CookieSession</span><span style=" color:#000000;">)</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">DestroySession(</span>w<span style=" color:#c0c0c0;"> </span>http<span style=" color:#000000;">.</span>ResponseWriter<span style=" color:#000000;">,</span><span style=" color:#c0c0c0;"> </span>r<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">*</span>http<span style=" color:#000000;">.</span>Request<span style=" color:#000000;">)</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">{</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;</span>ck<span style=" color:#000000;">,</span><span style=" color:#c0c0c0;"> </span>err<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">:=</span><span style=" color:#c0c0c0;"> </span>r<span style=" color:#000000;">.</span>Cookie<span style=" color:#000000;">(</span>cs<span style=" color:#000000;">.</span>cookieName<span style=" color:#000000;">)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=" font-weight:600; color:#000080;">if</span><span style=" color:#c0c0c0;"> </span>err<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">!=</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000080;">nil</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">{</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>fmt<span style=" color:#000000;">.</span>Println<span style=" color:#000000;">(</span>err<span style=" color:#000000;">)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=" color:#000000;">}</span><span style=" color:#c0c0c0;"> </span><span style=" font-weight:600; color:#000080;">else</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">{</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=" font-weight:600; color:#000080;">if</span><span style=" color:#c0c0c0;"> </span>ck<span style=" color:#000000;">.</span>Value<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">==</span><span style=" color:#c0c0c0;"> </span><span style=" color:#008000;">""</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">{</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>fmt<span style=" color:#000000;">.</span>Println<span style=" color:#000000;">(</span><span style=" color:#008000;">"cookie值不存在"</span><span style=" color:#000000;">)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=" color:#000000;">}</span><span style=" color:#c0c0c0;"> </span><span style=" font-weight:600; color:#000080;">else</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">{</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>cs<span style=" color:#000000;">.</span>lock<span style=" color:#000000;">.</span>Lock<span style=" color:#000000;">()</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=" font-weight:600; color:#000080;">defer</span><span style=" color:#c0c0c0;"> </span>cs<span style=" color:#000000;">.</span>lock<span style=" color:#000000;">.</span>Unlock<span style=" color:#000000;">()</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>cookie<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">:=</span><span style=" color:#c0c0c0;"> </span>http<span style=" color:#000000;">.</span>Cookie<span style=" color:#000000;">{</span>Name<span style=" color:#000000;">:</span><span style=" color:#c0c0c0;"> </span>cs<span style=" color:#000000;">.</span>cookieName<span style=" color:#000000;">,</span><span style=" color:#c0c0c0;"> </span>Path<span style=" color:#000000;">:</span><span style=" color:#c0c0c0;"> </span><span style=" color:#008000;">"/"</span><span style=" color:#000000;">,</span><span style=" color:#c0c0c0;"> </span>HttpOnly<span style=" color:#000000;">:</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000080;">true</span><span style=" color:#000000;">,</span><span style=" color:#c0c0c0;"> </span>Expires<span style=" color:#000000;">:</span><span style=" color:#c0c0c0;"> </span>time<span style=" color:#000000;">.</span>Now<span style=" color:#000000;">(),</span><span style=" color:#c0c0c0;"> </span>MaxAge<span style=" color:#000000;">:</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">-</span><span style=" color:#800080;">1</span><span style=" color:#000000;">}</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=" color:#000080;">delete</span><span style=" color:#000000;">(</span>cs<span style=" color:#000000;">.</span>sessions<span style=" color:#000000;">,</span><span style=" color:#c0c0c0;"> </span>ck<span style=" color:#000000;">.</span>Value<span style=" color:#000000;">)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>http<span style=" color:#000000;">.</span>SetCookie<span style=" color:#000000;">(</span>w<span style=" color:#000000;">,</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">&amp;</span>cookie<span style=" color:#000000;">)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=" color:#000000;">}</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=" color:#000000;">}</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#000000;">}</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#000080;">func</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">(</span>cs<span style=" color:#c0c0c0;"> </span><span style=" color:#000080;">CookieSession</span><span style=" color:#000000;">)</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">DestroySessions()</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">{</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;</span>cs<span style=" color:#000000;">.</span>lock<span style=" color:#000000;">.</span>Lock<span style=" color:#000000;">()</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=" font-weight:600; color:#000080;">defer</span><span style=" color:#c0c0c0;"> </span>cs<span style=" color:#000000;">.</span>lock<span style=" color:#000000;">.</span>Unlock<span style=" color:#000000;">()</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;</span>cs<span style=" color:#000000;">.</span>sessions<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">=</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000080;">make</span><span style=" color:#000000;">(</span><span style=" font-weight:600; color:#000080;">map</span><span style=" color:#000000;">[</span><span style=" color:#000080;">string</span><span style=" color:#000000;">]*</span>Session<span style=" color:#000000;">,</span><span style=" color:#c0c0c0;"> </span><span style=" color:#800080;">0</span><span style=" color:#000000;">)</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#000000;">}</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#000080;">func</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">unique()</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000080;">string</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">{</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;</span>crutime<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">:=</span><span style=" color:#c0c0c0;"> </span>time<span style=" color:#000000;">.</span>Now<span style=" color:#000000;">().</span>UnixNano<span style=" color:#000000;">()</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;</span>str<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">:=</span><span style=" color:#c0c0c0;"> </span>encode<span style=" color:#000000;">(</span>strconv<span style=" color:#000000;">.</span>FormatInt<span style=" color:#000000;">(</span>crutime<span style=" color:#000000;">,</span><span style=" color:#c0c0c0;"> </span><span style=" color:#800080;">10</span><span style=" color:#000000;">))</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;</span>r<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">:=</span><span style=" color:#c0c0c0;"> </span>rand<span style=" color:#000000;">.</span>New<span style=" color:#000000;">(</span>rand<span style=" color:#000000;">.</span>NewSource<span style=" color:#000000;">(</span>time<span style=" color:#000000;">.</span>Now<span style=" color:#000000;">().</span>UnixNano<span style=" color:#000000;">()))</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;</span>randstr<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">:=</span><span style=" color:#c0c0c0;"> </span>strconv<span style=" color:#000000;">.</span>Itoa<span style=" color:#000000;">(</span>r<span style=" color:#000000;">.</span>Intn<span style=" color:#000000;">(</span><span style=" color:#800080;">99999999</span><span style=" color:#000000;">))</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;</span>unique<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">:=</span><span style=" color:#c0c0c0;"> </span>encode<span style=" color:#000000;">(</span>str<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">+</span><span style=" color:#c0c0c0;"> </span>randstr<span style=" color:#000000;">)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=" font-weight:600; color:#000080;">return</span><span style=" color:#c0c0c0;"> </span>unique</pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#000000;">}</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#000080;">func</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">encode(</span>str<span style=" color:#c0c0c0;"> </span><span style=" color:#000080;">string</span><span style=" color:#000000;">)</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000080;">string</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">{</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;</span>md5init<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">:=</span><span style=" color:#c0c0c0;"> </span>md5<span style=" color:#000000;">.</span>New<span style=" color:#000000;">()</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;</span>io<span style=" color:#000000;">.</span>WriteString<span style=" color:#000000;">(</span>md5init<span style=" color:#000000;">,</span><span style=" color:#c0c0c0;"> </span>str<span style=" color:#000000;">)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;</span>md5value<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">:=</span><span style=" color:#c0c0c0;"> </span>fmt<span style=" color:#000000;">.</span>Sprintf<span style=" color:#000000;">(</span><span style=" color:#008000;">"%x"</span><span style=" color:#000000;">,</span><span style=" color:#c0c0c0;"> </span>md5init<span style=" color:#000000;">.</span>Sum<span style=" color:#000000;">(</span><span style=" color:#000080;">nil</span><span style=" color:#000000;">))</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#c0c0c0;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=" font-weight:600; color:#000080;">return</span><span style=" color:#c0c0c0;"> </span>md5value</pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#000000;">}</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br></pre>