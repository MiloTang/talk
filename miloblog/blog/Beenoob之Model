  
	<pre style="background-color:#fdf6e3;color:#586e75;font-family:'Source Code Pro';font-size:13.5pt;"><span style="color:#dc322f;">&lt;?php<br></span><span style="color:#859900;">namespace </span><span style="color:#839496;">Core</span>\<span style="color:#839496;">libs</span>;<br><span style="color:#839496;">defined</span>(<span style="color:#2aa198;">'CORE_PATH'</span>) <span style="color:#859900;">or exit</span>();<br><span style="color:#859900;">class </span><span style="color:#b58900;">Model<br></span><span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">    </span><span style="color:#859900;">private </span><span style="color:#6c71c4;">$_dsn</span>;<br>    <span style="color:#859900;">private </span><span style="color:#6c71c4;">$_port</span>;<br>    <span style="color:#859900;">private </span><span style="color:#6c71c4;">$_username</span>;<br>    <span style="color:#859900;">private </span><span style="color:#6c71c4;">$_password</span>;<br>    <span style="color:#859900;">private </span><span style="color:#6c71c4;">$_charset</span>;<br>    <span style="color:#859900;">private </span><span style="color:#6c71c4;">$_dbName</span>;<br>    <span style="color:#859900;">private static </span><span style="color:#d33682;">$_instance</span>;<br>    <span style="color:#859900;">private </span><span style="color:#6c71c4;">$_pdo</span>;<br>    <span style="color:#859900;">private </span><span style="color:#6c71c4;">$_dbConf</span>;<br>    <span style="color:#859900;">private </span><span style="color:#6c71c4;">$_sql</span>;<br>    <span style="color:#859900;">private </span><span style="color:#6c71c4;">$_params</span>;<br>    <span style="color:#859900;">private </span><span style="color:#6c71c4;">$_stmt</span>;<br>    <span style="color:#859900;">private function </span><span style="color:#839496;">__clone</span>()<br>    <span style="color:#dc322f;">{<br></span><span style="color:#dc322f;"><br></span><span style="color:#dc322f;">    }<br></span><span style="color:#dc322f;">    </span><span style="color:#859900;">private function </span><span style="color:#839496;">__construct</span>()<br>    <span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">        </span><span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#839496;">_initDBCConf</span>();<br>        <span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#6c71c4;">_pdo</span><span style="color:#079a71;">=</span><span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#839496;">_link</span>();<br>        <span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#839496;">_setCharset</span>();<br>        <span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#839496;">_selectDB</span>();<br>    <span style="color:#dc322f;">}<br></span><span style="color:#dc322f;">    </span><span style="color:#859900;">private function </span><span style="color:#839496;">_initDBCConf</span>()<br>    <span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">        </span><span style="color:#268bd2;">$conf</span><span style="color:#079a71;">=</span><span style="color:#b58900;">Conf</span><span style="color:#079a71;">::</span><span style="color:#969483;">getInstance</span>()<span style="color:#079a71;">-&gt;</span><span style="color:#839496;">conf</span>();<br>        <span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#6c71c4;">_dbConf</span><span style="color:#079a71;">=</span><span style="color:#859900;">isset</span>(<span style="color:#268bd2;">$conf[</span><span style="color:#2aa198;">'DB'</span><span style="color:#268bd2;">][</span><span style="color:#2aa198;">'Mysql'</span><span style="color:#268bd2;">]</span>)<span style="color:#079a71;">?</span><span style="color:#268bd2;">$conf[</span><span style="color:#2aa198;">'DB'</span><span style="color:#268bd2;">][</span><span style="color:#2aa198;">'Mysql'</span><span style="color:#268bd2;">]</span><span style="color:#079a71;">:</span><span style="color:#839496;">GetError</span>(<span style="color:#2aa198;">'</span><span style="color:#2aa198;font-family:'Courier New';">请检查配置文件</span><span style="color:#2aa198;">'</span>);<br>        <span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#6c71c4;">_dsn </span><span style="color:#079a71;">= </span><span style="color:#859900;">isset</span>(<span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#6c71c4;">_dbConf</span><span style="color:#268bd2;">[</span><span style="color:#2aa198;">'dsn'</span><span style="color:#268bd2;">]</span>)<span style="color:#079a71;">?</span><span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#6c71c4;">_dbConf</span><span style="color:#268bd2;">[</span><span style="color:#2aa198;">'dsn'</span><span style="color:#268bd2;">]</span><span style="color:#079a71;">:</span><span style="color:#839496;">GetError</span>(<span style="color:#2aa198;">'</span><span style="color:#2aa198;font-family:'Courier New';">请配置</span><span style="color:#2aa198;">dsn'</span>);<br>        <span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#6c71c4;">_dbName </span><span style="color:#079a71;">= </span><span style="color:#859900;">isset</span>(<span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#6c71c4;">_dbConf</span><span style="color:#268bd2;">[</span><span style="color:#2aa198;">'dbName'</span><span style="color:#268bd2;">]</span>)<span style="color:#079a71;">?</span><span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#6c71c4;">_dbConf</span><span style="color:#268bd2;">[</span><span style="color:#2aa198;">'dbName'</span><span style="color:#268bd2;">]</span><span style="color:#079a71;">:</span><span style="color:#839496;">GetError</span>(<span style="color:#2aa198;">'</span><span style="color:#2aa198;font-family:'Courier New';">请配置数据库</span><span style="color:#2aa198;">'</span>);<br>        <span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#6c71c4;">_username </span><span style="color:#079a71;">= </span><span style="color:#859900;">isset</span>(<span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#6c71c4;">_dbConf</span><span style="color:#268bd2;">[</span><span style="color:#2aa198;">'username'</span><span style="color:#268bd2;">]</span>)<span style="color:#079a71;">?</span><span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#6c71c4;">_dbConf</span><span style="color:#268bd2;">[</span><span style="color:#2aa198;">'username'</span><span style="color:#268bd2;">]</span><span style="color:#079a71;">:</span><span style="color:#839496;">GetError</span>(<span style="color:#2aa198;">'</span><span style="color:#2aa198;font-family:'Courier New';">请配置用户名</span><span style="color:#2aa198;">'</span>);<br>        <span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#6c71c4;">_password </span><span style="color:#079a71;">= </span><span style="color:#859900;">isset</span>(<span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#6c71c4;">_dbConf</span><span style="color:#268bd2;">[</span><span style="color:#2aa198;">'password'</span><span style="color:#268bd2;">]</span>)<span style="color:#079a71;">?</span><span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#6c71c4;">_dbConf</span><span style="color:#268bd2;">[</span><span style="color:#2aa198;">'password'</span><span style="color:#268bd2;">]</span><span style="color:#079a71;">:</span><span style="color:#839496;">GetError</span>(<span style="color:#2aa198;">'</span><span style="color:#2aa198;font-family:'Courier New';">请配置用户密码</span><span style="color:#2aa198;">'</span>);<br>        <span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#6c71c4;">_charset </span><span style="color:#079a71;">= </span><span style="color:#859900;">isset</span>(<span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#6c71c4;">_dbConf</span><span style="color:#268bd2;">[</span><span style="color:#2aa198;">'charset'</span><span style="color:#268bd2;">]</span>)<span style="color:#079a71;">?</span><span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#6c71c4;">_dbConf</span><span style="color:#268bd2;">[</span><span style="color:#2aa198;">'charset'</span><span style="color:#268bd2;">]</span><span style="color:#079a71;">:</span><span style="color:#839496;">GetError</span>(<span style="color:#2aa198;">'</span><span style="color:#2aa198;font-family:'Courier New';">请配置字符集</span><span style="color:#2aa198;">'</span>);<br>        <span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#6c71c4;">_port </span><span style="color:#079a71;">= </span><span style="color:#859900;">isset</span>(<span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#6c71c4;">_dbConf</span><span style="color:#268bd2;">[</span><span style="color:#2aa198;">'port'</span><span style="color:#268bd2;">]</span>)<span style="color:#079a71;">?</span><span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#6c71c4;">_dbConf</span><span style="color:#268bd2;">[</span><span style="color:#2aa198;">'port'</span><span style="color:#268bd2;">]</span><span style="color:#079a71;">:</span><span style="color:#839496;">GetError</span>(<span style="color:#2aa198;">'</span><span style="color:#2aa198;font-family:'Courier New';">请配置端口</span><span style="color:#2aa198;">'</span>);<br>    <span style="color:#dc322f;">}<br></span><span style="color:#dc322f;">    </span><span style="color:#859900;">private function </span><span style="color:#839496;">_link</span>()<span style="color:#079a71;">:</span>\<span style="color:#839496;">PDO<br></span><span style="color:#839496;">    </span><span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">        </span><span style="color:#859900;">try<br></span><span style="color:#859900;">        </span><span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">            </span><span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#6c71c4;">_dsn </span><span style="color:#079a71;">= </span><span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#6c71c4;">_dsn</span><span style="color:#079a71;">.</span><span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#6c71c4;">_port</span>;<br>            <span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#6c71c4;">_pdo </span><span style="color:#079a71;">= </span><span style="color:#859900;">new </span>\<span style="color:#839496;">PDO</span>(<span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#6c71c4;">_dsn</span>,<span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#6c71c4;">_username</span>, <span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#6c71c4;">_password</span>);<br>            <span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#6c71c4;">_pdo</span><span style="color:#079a71;">-&gt;</span><span style="color:#839496;">setAttribute</span>(\<span style="color:#b58900;">PDO</span><span style="color:#079a71;">::</span><span style="color:#d33682;">ATTR_ERRMODE</span>, \<span style="color:#b58900;">PDO</span><span style="color:#079a71;">::</span><span style="color:#d33682;">ERRMODE_EXCEPTION</span>);<br>            <span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#6c71c4;">_pdo</span><span style="color:#079a71;">-&gt;</span><span style="color:#839496;">setAttribute</span>(\<span style="color:#b58900;">PDO</span><span style="color:#079a71;">::</span><span style="color:#d33682;">ATTR_DEFAULT_FETCH_MODE</span>, \<span style="color:#b58900;">PDO</span><span style="color:#079a71;">::</span><span style="color:#d33682;">FETCH_ASSOC</span>);<br>            <span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#6c71c4;">_pdo</span><span style="color:#079a71;">-&gt;</span><span style="color:#839496;">setAttribute</span>(\<span style="color:#b58900;">PDO</span><span style="color:#079a71;">::</span><span style="color:#d33682;">MYSQL_ATTR_USE_BUFFERED_QUERY</span>,<span style="color:#859900;">true</span>);<br>        <span style="color:#dc322f;">} </span><span style="color:#859900;">catch </span>(\<span style="color:#839496;">PDOException </span><span style="color:#268bd2;">$e</span>) <span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">               </span><span style="color:#839496;">GetError</span>(<span style="color:#268bd2;">$e</span><span style="color:#079a71;">-&gt;</span><span style="color:#839496;">getMessage</span>());<br>        <span style="color:#dc322f;">}<br></span><span style="color:#dc322f;">        </span><span style="color:#859900;">return </span><span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#6c71c4;">_pdo</span>;<br>    <span style="color:#dc322f;">}<br></span><span style="color:#dc322f;">    </span><span style="color:#859900;">static public function </span><span style="color:#839496;">getInstance</span>()<br>    <span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">        </span><span style="color:#859900;">if </span>(<span style="color:#079a71;">!</span>(<span style="color:#859900;">self</span><span style="color:#079a71;">::</span><span style="color:#d33682;">$_instance </span><span style="color:#859900;">instanceof static</span>))<br>        <span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">            </span><span style="color:#859900;">self</span><span style="color:#079a71;">::</span><span style="color:#d33682;">$_instance </span><span style="color:#079a71;">= </span><span style="color:#859900;">new self</span>();<br>        <span style="color:#dc322f;">}<br></span><span style="color:#dc322f;">        </span><span style="color:#859900;">return self</span><span style="color:#079a71;">::</span><span style="color:#d33682;">$_instance</span>;<br>    <span style="color:#dc322f;">}<br></span><span style="color:#dc322f;">    </span><span style="color:#859900;">private function </span><span style="color:#839496;">_setCharset</span>()<br>    <span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">        </span><span style="color:#268bd2;">$sql </span><span style="color:#079a71;">= </span><span style="color:#2aa198;">'SET NAMES '</span><span style="color:#079a71;">.</span><span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#6c71c4;">_charset</span>;<br>        <span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#6c71c4;">_pdo</span><span style="color:#079a71;">-&gt;</span><span style="color:#839496;">query</span>(<span style="color:#268bd2;">$sql</span>);<br>    <span style="color:#dc322f;">}<br></span><span style="color:#dc322f;"><br></span><span style="color:#dc322f;">    </span><span style="color:#859900;">private function </span><span style="color:#839496;">_selectDB</span>()<br>    <span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">        </span><span style="color:#268bd2;">$sql </span><span style="color:#079a71;">= </span><span style="color:#2aa198;">'USE '</span><span style="color:#079a71;">.</span><span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#6c71c4;">_dbName</span>;<br>        <span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#6c71c4;">_pdo</span><span style="color:#079a71;">-&gt;</span><span style="color:#839496;">query</span>(<span style="color:#268bd2;">$sql</span>);<br>    <span style="color:#dc322f;">}<br></span><span style="color:#dc322f;">    </span><span style="color:#93a1a1;font-style:italic;">/**<br></span><span style="color:#93a1a1;font-style:italic;">     * </span><span style="color:#93a1a1;font-weight:bold;font-style:italic;">@param </span><span style="color:#93a1a1;font-style:italic;">$sql<br></span><span style="color:#93a1a1;font-style:italic;">     * </span><span style="color:#93a1a1;font-weight:bold;font-style:italic;">@param </span><span style="color:#93a1a1;font-style:italic;">$bindParams<br></span><span style="color:#93a1a1;font-style:italic;">     * </span><span style="color:#93a1a1;font-weight:bold;font-style:italic;">@param </span><span style="color:#93a1a1;font-style:italic;">bool $debug<br></span><span style="color:#93a1a1;font-style:italic;">     * </span><span style="color:#93a1a1;font-weight:bold;font-style:italic;">@return </span><span style="color:#93a1a1;font-style:italic;">mixed<br></span><span style="color:#93a1a1;font-style:italic;">     */<br></span><span style="color:#93a1a1;font-style:italic;">    </span><span style="color:#859900;">public function </span><span style="color:#839496;">doSql</span>(<span style="color:#839496;">$sql</span>,<span style="color:#839496;">$bindParams</span><span style="color:#079a71;">=</span><span style="color:#859900;">null</span>,<span style="color:#839496;">$debug</span><span style="color:#079a71;">=</span><span style="color:#859900;">false</span>)<br>    <span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">        </span><span style="color:#859900;">if</span>(<span style="color:#839496;">$debug</span>)<br>        <span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">            </span><span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#839496;">debug</span>();<br>        <span style="color:#dc322f;">}<br></span><span style="color:#dc322f;">        </span><span style="color:#859900;">try<br></span><span style="color:#859900;">        </span><span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">            </span><span style="color:#268bd2;">$stmt </span><span style="color:#079a71;">= </span><span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#6c71c4;">_pdo</span><span style="color:#079a71;">-&gt;</span><span style="color:#839496;">prepare</span>(<span style="color:#839496;">$sql</span>);<br>            <span style="color:#268bd2;">$stmt</span><span style="color:#079a71;">-&gt;</span><span style="color:#839496;">execute</span>(<span style="color:#839496;">$bindParams</span>);<br>            <span style="color:#859900;">return </span><span style="color:#268bd2;">$stmt</span>;<br>        <span style="color:#dc322f;">}<br></span><span style="color:#dc322f;">        </span><span style="color:#859900;">catch </span>(\<span style="color:#839496;">PDOException </span><span style="color:#268bd2;">$e</span>)<br>        <span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">                </span><span style="color:#839496;">GetError</span>(<span style="color:#268bd2;">$e</span><span style="color:#079a71;">-&gt;</span><span style="color:#839496;">getMessage</span>());<br>        <span style="color:#dc322f;">}<br></span><span style="color:#dc322f;">        </span><span style="color:#859900;">return null</span>;<br>    <span style="color:#dc322f;">}<br></span><span style="color:#dc322f;">    </span><span style="color:#93a1a1;font-style:italic;">/**<br></span><span style="color:#93a1a1;font-style:italic;">     * </span><span style="color:#93a1a1;font-weight:bold;font-style:italic;">@param </span><span style="color:#93a1a1;font-style:italic;">$table<br></span><span style="color:#93a1a1;font-style:italic;">     * </span><span style="color:#93a1a1;font-weight:bold;font-style:italic;">@return </span><span style="color:#93a1a1;font-style:italic;">bool<br></span><span style="color:#93a1a1;font-style:italic;">     */<br></span><span style="color:#93a1a1;font-style:italic;">    </span><span style="color:#859900;">public function </span><span style="color:#839496;">checkTable</span>(<span style="color:#839496;">$table</span>)<span style="color:#079a71;">:</span><span style="color:#839496;">bool<br></span><span style="color:#839496;">    </span><span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">        </span><span style="color:#268bd2;">$rst </span><span style="color:#079a71;">= </span><span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#6c71c4;">_pdo</span><span style="color:#079a71;">-&gt;</span><span style="color:#839496;">query</span>(<span style="color:#2aa198;">'show tables'</span>)<span style="color:#079a71;">-&gt;</span><span style="color:#839496;">fetchAll</span>();<br>        <span style="color:#859900;">foreach </span>(<span style="color:#268bd2;">$rst </span><span style="color:#859900;">as </span><span style="color:#268bd2;">$keys </span><span style="color:#079a71;">=&gt; </span><span style="color:#268bd2;">$values</span>)<br>        <span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">             </span><span style="color:#859900;">if </span>(<span style="color:#839496;">$table</span><span style="color:#079a71;">==</span><span style="color:#268bd2;">$values[</span><span style="color:#2aa198;">"Tables_in_.</span><span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#6c71c4;">_dbName</span><span style="color:#2aa198;">"</span><span style="color:#268bd2;">]</span>)<br>             <span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">                 </span><span style="color:#859900;">return true</span>;<br>             <span style="color:#dc322f;">}<br></span><span style="color:#dc322f;">        }<br></span><span style="color:#dc322f;">        </span><span style="color:#859900;">return false</span>;<br>    <span style="color:#dc322f;">}<br></span><span style="color:#dc322f;"><br></span><span style="color:#dc322f;">    </span><span style="color:#93a1a1;font-style:italic;">/**<br></span><span style="color:#93a1a1;font-style:italic;">     * </span><span style="color:#93a1a1;font-weight:bold;font-style:italic;">@param </span><span style="color:#93a1a1;font-style:italic;">$table<br></span><span style="color:#93a1a1;font-style:italic;">     * </span><span style="color:#93a1a1;font-weight:bold;font-style:italic;">@param </span><span style="color:#93a1a1;font-style:italic;">$field<br></span><span style="color:#93a1a1;font-style:italic;">     * </span><span style="color:#93a1a1;font-weight:bold;font-style:italic;">@return </span><span style="color:#93a1a1;font-style:italic;">bool<br></span><span style="color:#93a1a1;font-style:italic;">     */<br></span><span style="color:#93a1a1;font-style:italic;">    </span><span style="color:#859900;">public function </span><span style="color:#839496;">checkField</span>(<span style="color:#839496;">$table</span>,<span style="color:#839496;">$field</span>)<span style="color:#079a71;">:</span><span style="color:#839496;">bool<br></span><span style="color:#839496;">    </span><span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">        </span><span style="color:#268bd2;">$rst </span><span style="color:#079a71;">= </span><span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#6c71c4;">_pdo</span><span style="color:#079a71;">-&gt;</span><span style="color:#839496;">query</span>(<span style="color:#2aa198;">"desc </span><span style="color:#839496;">$table</span><span style="color:#2aa198;">"</span>)<span style="color:#079a71;">-&gt;</span><span style="color:#839496;">fetchAll</span>();<br>        <span style="color:#859900;">foreach </span>(<span style="color:#268bd2;">$rst </span><span style="color:#859900;">as </span><span style="color:#268bd2;">$keys </span><span style="color:#079a71;">=&gt; </span><span style="color:#268bd2;">$values</span>)<br>        <span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">            </span><span style="color:#859900;">if </span>(<span style="color:#839496;">$field</span><span style="color:#079a71;">==</span><span style="color:#268bd2;">$values[</span><span style="color:#2aa198;">'Field'</span><span style="color:#268bd2;">]</span>)<br>            <span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">                </span><span style="color:#859900;">return true</span>;<br>                <span style="color:#859900;">break</span>;<br>            <span style="color:#dc322f;">}<br></span><span style="color:#dc322f;">        }<br></span><span style="color:#dc322f;">        </span><span style="color:#859900;">return false</span>;<br>    <span style="color:#dc322f;">}<br></span><span style="color:#dc322f;"><br></span><span style="color:#dc322f;">    </span><span style="color:#859900;">public function </span><span style="color:#839496;">counts</span>(<span style="color:#839496;">$table</span>) <span style="color:#079a71;">: </span><span style="color:#839496;">int<br></span><span style="color:#839496;">    </span><span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">        </span><span style="color:#268bd2;">$sql</span><span style="color:#079a71;">=</span><span style="color:#2aa198;">''</span><span style="color:#079a71;">.</span><span style="color:#2aa198;">'select count(*) from '</span><span style="color:#079a71;">.</span><span style="color:#839496;">$table</span>;<br>        <span style="color:#268bd2;">$rowCount</span><span style="color:#079a71;">=</span><span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#6c71c4;">_pdo</span><span style="color:#079a71;">-&gt;</span><span style="color:#839496;">query</span>(<span style="color:#268bd2;">$sql</span>)<span style="color:#079a71;">-&gt;</span><span style="color:#839496;">fetchColumn</span>();<br>        <span style="color:#859900;">return </span><span style="color:#268bd2;">$rowCount</span>;<br>    <span style="color:#dc322f;">}<br></span><span style="color:#dc322f;"><br></span><span style="color:#dc322f;">    </span><span style="color:#859900;">public function </span><span style="color:#839496;">select</span>(<span style="color:#839496;">string $table</span>, <span style="color:#839496;">$fields </span><span style="color:#079a71;">= </span><span style="color:#2aa198;">'*'</span>)<br>    <span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">        </span><span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#6c71c4;">_sql</span><span style="color:#079a71;">=</span><span style="color:#859900;">null</span>;<br>        <span style="color:#268bd2;">$str </span><span style="color:#079a71;">= </span><span style="color:#839496;">is_array</span>( <span style="color:#839496;">$fields </span>) <span style="color:#079a71;">? </span><span style="color:#839496;">implode</span>( <span style="color:#2aa198;">','</span>, <span style="color:#839496;">$fields </span>) <span style="color:#079a71;">: </span><span style="color:#839496;">$fields</span>;<br>        <span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#6c71c4;">_sql </span><span style="color:#079a71;">= </span><span style="color:#2aa198;">'SELECT ' </span><span style="color:#079a71;">. </span><span style="color:#268bd2;">$str </span><span style="color:#079a71;">. </span><span style="color:#2aa198;">' FROM ' </span><span style="color:#079a71;">.  </span><span style="color:#839496;">$table </span><span style="color:#079a71;">. </span><span style="color:#2aa198;">' '</span>;<br>        <span style="color:#859900;">return </span><span style="color:#268bd2;">$this</span>;<br>    <span style="color:#dc322f;">}<br></span><span style="color:#dc322f;">    </span><span style="color:#859900;">public function </span><span style="color:#839496;">where</span>(<span style="color:#839496;">$str</span>,<span style="color:#839496;">$params</span><span style="color:#079a71;">=</span><span style="color:#859900;">null</span>)<br>    <span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">        </span><span style="color:#859900;">foreach </span>(<span style="color:#839496;">$params </span><span style="color:#859900;">as </span><span style="color:#268bd2;">$item</span><span style="color:#079a71;">=&gt;</span><span style="color:#268bd2;">$value</span>)<br>        <span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">            </span><span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#6c71c4;">_params</span><span style="color:#268bd2;">[$item]</span><span style="color:#079a71;">=</span><span style="color:#268bd2;">$value</span>;<br>        <span style="color:#dc322f;">}<br></span><span style="color:#dc322f;">        </span><span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#6c71c4;">_sql</span><span style="color:#079a71;">=</span><span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#6c71c4;">_sql</span><span style="color:#079a71;">.</span><span style="color:#2aa198;">'where '</span><span style="color:#079a71;">.</span><span style="color:#839496;">$str </span><span style="color:#079a71;">.</span><span style="color:#2aa198;">' '</span>;<br>        <span style="color:#859900;">return </span><span style="color:#268bd2;">$this</span>;<br>    <span style="color:#dc322f;">}<br></span><span style="color:#dc322f;">    </span><span style="color:#859900;">function </span><span style="color:#839496;">order</span>(<span style="color:#839496;">$str</span>)<br>    <span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">        </span><span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#6c71c4;">_sql </span><span style="color:#079a71;">= </span><span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#6c71c4;">_sql</span><span style="color:#079a71;">.</span><span style="color:#2aa198;">" ORDER BY </span><span style="color:#839496;">$str</span><span style="color:#2aa198;">"</span>;<br>        <span style="color:#859900;">return </span><span style="color:#268bd2;">$this</span>;<br>    <span style="color:#dc322f;">}<br></span><span style="color:#dc322f;">    </span><span style="color:#859900;">function </span><span style="color:#839496;">limit</span>(<span style="color:#839496;">$len </span><span style="color:#079a71;">= </span><span style="color:#2aa198;">10</span>, <span style="color:#839496;">$start </span><span style="color:#079a71;">= </span><span style="color:#2aa198;">0</span>)<br>    <span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">        </span><span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#6c71c4;">_sql </span><span style="color:#079a71;">= </span><span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#6c71c4;">_sql</span><span style="color:#079a71;">.</span><span style="color:#2aa198;">" LIMIT </span><span style="color:#839496;">$start</span><span style="color:#2aa198;">,</span><span style="color:#839496;">$len</span><span style="color:#2aa198;">"</span>;<br>        <span style="color:#859900;">return </span><span style="color:#268bd2;">$this</span>;<br>    <span style="color:#dc322f;">}<br></span><span style="color:#dc322f;">    </span><span style="color:#859900;">public function </span><span style="color:#839496;">execute</span>()<br>    <span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">        </span><span style="color:#859900;">try<br></span><span style="color:#859900;">        </span><span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">            </span><span style="color:#268bd2;">$stmt </span><span style="color:#079a71;">= </span><span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#6c71c4;">_pdo</span><span style="color:#079a71;">-&gt;</span><span style="color:#839496;">prepare</span>(<span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#6c71c4;">_sql</span>);<br>            <span style="color:#268bd2;">$stmt</span><span style="color:#079a71;">-&gt;</span><span style="color:#839496;">execute</span>(<span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#6c71c4;">_params</span>);<br>            <span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#6c71c4;">_stmt</span><span style="color:#079a71;">=</span><span style="color:#268bd2;">$stmt</span>;<br>        <span style="color:#dc322f;">}<br></span><span style="color:#dc322f;">        </span><span style="color:#859900;">catch </span>(\<span style="color:#839496;">PDOException </span><span style="color:#268bd2;">$e</span>)<br>        <span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">            </span><span style="color:#839496;">GetError</span>(<span style="color:#268bd2;">$e</span><span style="color:#079a71;">-&gt;</span><span style="color:#839496;">getMessage</span>());<br>        <span style="color:#dc322f;">}<br></span><span style="color:#dc322f;">        </span><span style="color:#859900;">return true</span>;<br>    <span style="color:#dc322f;">}<br></span><span style="color:#dc322f;">    </span><span style="color:#859900;">function </span><span style="color:#839496;">fetchAll</span>()<br>    <span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">        </span><span style="color:#859900;">if </span>(<span style="color:#d33682;">CACHE_DB_M</span>)<br>        <span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">            </span><span style="color:#268bd2;">$cache</span><span style="color:#079a71;">=</span><span style="color:#b58900;">MemCachedCache</span><span style="color:#079a71;">::</span><span style="color:#969483;">getInstance</span>();<br>            <span style="color:#268bd2;">$cacheData</span><span style="color:#079a71;">=</span><span style="color:#268bd2;">$cache</span><span style="color:#079a71;">-&gt;</span><span style="color:#839496;">getCache</span>(<span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#6c71c4;">_sql</span>);<br>            <span style="color:#859900;">if </span>(<span style="color:#268bd2;">$cacheData</span><span style="color:#079a71;">==</span><span style="color:#859900;">null</span>)<br>            <span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">                </span><span style="color:#268bd2;">$data</span><span style="color:#079a71;">=</span><span style="color:#859900;">array</span>();<br>                <span style="color:#859900;">if </span>(<span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#839496;">execute</span>())<br>                <span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">                    </span><span style="color:#268bd2;">$data</span><span style="color:#079a71;">=</span><span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#6c71c4;">_stmt</span><span style="color:#079a71;">-&gt;</span><span style="color:#839496;">fetchAll</span>();<br>                <span style="color:#dc322f;">}<br></span><span style="color:#dc322f;">                </span><span style="color:#268bd2;">$cache</span><span style="color:#079a71;">-&gt;</span><span style="color:#839496;">setCache</span>(<span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#6c71c4;">_sql</span>,<span style="color:#268bd2;">$data</span>);<br>                <span style="color:#859900;">return </span><span style="color:#268bd2;">$data</span>;<br>            <span style="color:#dc322f;">}<br></span><span style="color:#dc322f;">            </span><span style="color:#859900;">else<br></span><span style="color:#859900;">            </span><span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">                </span><span style="color:#859900;">return </span><span style="color:#268bd2;">$cacheData</span>;<br>            <span style="color:#dc322f;">}<br></span><span style="color:#dc322f;">        }<br></span><span style="color:#dc322f;">        </span><span style="color:#859900;">elseif</span>(<span style="color:#d33682;">CACHE_DB_R</span>)<br>        <span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">            </span><span style="color:#268bd2;">$cache</span><span style="color:#079a71;">=</span><span style="color:#b58900;">RedisCache</span><span style="color:#079a71;">::</span><span style="color:#969483;">getInstance</span>();<br>            <span style="color:#268bd2;">$cacheData</span><span style="color:#079a71;">=</span><span style="color:#268bd2;">$cache</span><span style="color:#079a71;">-&gt;</span><span style="color:#839496;">getCache</span>(<span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#6c71c4;">_sql</span>);<br>            <span style="color:#859900;">if </span>(<span style="color:#268bd2;">$cacheData</span><span style="color:#079a71;">==</span><span style="color:#859900;">null</span>)<br>            <span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">                </span><span style="color:#268bd2;">$data</span><span style="color:#079a71;">=</span><span style="color:#859900;">array</span>();<br>                <span style="color:#859900;">if </span>(<span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#839496;">execute</span>())<br>                <span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">                    </span><span style="color:#268bd2;">$data</span><span style="color:#079a71;">=</span><span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#6c71c4;">_stmt</span><span style="color:#079a71;">-&gt;</span><span style="color:#839496;">fetchAll</span>();<br>                <span style="color:#dc322f;">}<br></span><span style="color:#dc322f;">                </span><span style="color:#268bd2;">$cache</span><span style="color:#079a71;">-&gt;</span><span style="color:#839496;">setCache</span>(<span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#6c71c4;">_sql</span>,<span style="color:#268bd2;">$data</span>);<br>                <span style="color:#859900;">return </span><span style="color:#268bd2;">$data</span>;<br>            <span style="color:#dc322f;">}<br></span><span style="color:#dc322f;">            </span><span style="color:#859900;">else<br></span><span style="color:#859900;">            </span><span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">                </span><span style="color:#859900;">return </span><span style="color:#268bd2;">$cacheData</span>;<br>            <span style="color:#dc322f;">}<br></span><span style="color:#dc322f;">        }<br></span><span style="color:#dc322f;">        </span><span style="color:#859900;">else<br></span><span style="color:#859900;">        </span><span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">            </span><span style="color:#859900;">if </span>(<span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#839496;">execute</span>())<br>            <span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">               </span><span style="color:#859900;">return </span><span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#6c71c4;">_stmt</span><span style="color:#079a71;">-&gt;</span><span style="color:#839496;">fetchAll</span>();<br>            <span style="color:#dc322f;">}<br></span><span style="color:#dc322f;">        }<br></span><span style="color:#dc322f;">        </span><span style="color:#859900;">return null</span>;<br>    <span style="color:#dc322f;">}<br></span><span style="color:#dc322f;">    </span><span style="color:#859900;">function </span><span style="color:#839496;">fetchRow</span>()<br>    <span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">        </span><span style="color:#859900;">if </span>(<span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#839496;">execute</span>())<br>        <span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">            </span><span style="color:#859900;">return </span><span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#6c71c4;">_stmt</span><span style="color:#079a71;">-&gt;</span><span style="color:#839496;">fetch</span>();<br>        <span style="color:#dc322f;">}<br></span><span style="color:#dc322f;">        </span><span style="color:#859900;">return null</span>;<br>    <span style="color:#dc322f;">}<br></span><span style="color:#dc322f;">    </span><span style="color:#859900;">public function </span><span style="color:#839496;">insert</span>(<span style="color:#839496;">string $table</span>,<span style="color:#859900;">array </span><span style="color:#839496;">$fields</span>)<br>    <span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">        </span><span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#6c71c4;">_sql</span><span style="color:#079a71;">=</span><span style="color:#859900;">null</span>;<br>        <span style="color:#268bd2;">$field1 </span><span style="color:#079a71;">= </span><span style="color:#839496;">current</span>(<span style="color:#839496;">$fields</span>);<br>        <span style="color:#859900;">if </span>(<span style="color:#839496;">is_array</span>( <span style="color:#268bd2;">$field1 </span>))<br>        <span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">            </span><span style="color:#268bd2;">$str</span><span style="color:#079a71;">=</span><span style="color:#859900;">null</span>;<br>            <span style="color:#268bd2;">$i</span><span style="color:#079a71;">=</span><span style="color:#2aa198;">0</span>;<br>            <span style="color:#268bd2;">$tempValue</span><span style="color:#079a71;">=</span><span style="color:#859900;">array</span>();<br>            <span style="color:#268bd2;">$lowNames</span><span style="color:#079a71;">=</span><span style="color:#859900;">array</span>();<br>            <span style="color:#859900;">foreach </span>(<span style="color:#839496;">$fields </span><span style="color:#859900;">as </span><span style="color:#268bd2;">$field</span>)<br>            <span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">                </span><span style="color:#268bd2;">$lowNames </span><span style="color:#079a71;">= </span><span style="color:#839496;">array_keys</span>(<span style="color:#268bd2;">$field</span>);<br>                <span style="color:#268bd2;">$temp </span><span style="color:#079a71;">= </span><span style="color:#859900;">array</span>();<br>                <span style="color:#859900;">foreach </span>(<span style="color:#268bd2;">$field </span><span style="color:#859900;">as </span><span style="color:#268bd2;">$item </span><span style="color:#079a71;">=&gt; </span><span style="color:#268bd2;">$value</span>) <span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">                    </span><span style="color:#268bd2;">$temp[] </span><span style="color:#079a71;">= </span><span style="color:#2aa198;">':'</span><span style="color:#079a71;">. </span><span style="color:#268bd2;">$item</span><span style="color:#079a71;">.</span><span style="color:#268bd2;">$i</span>;<br>                    <span style="color:#268bd2;">$tempValue[</span><span style="color:#2aa198;">':' </span><span style="color:#079a71;">. </span><span style="color:#268bd2;">$item</span><span style="color:#079a71;">.</span><span style="color:#268bd2;">$i] </span><span style="color:#079a71;">= </span><span style="color:#268bd2;">$value</span>;<br><br>                <span style="color:#dc322f;">}<br></span><span style="color:#dc322f;">                </span><span style="color:#268bd2;">$i</span><span style="color:#079a71;">++</span>;<br>                <span style="color:#268bd2;">$lowValues </span><span style="color:#079a71;">= </span><span style="color:#839496;">implode</span>(<span style="color:#2aa198;">','</span>, <span style="color:#268bd2;">$temp</span>);<br>                <span style="color:#859900;">if</span>(<span style="color:#268bd2;">$str</span><span style="color:#079a71;">!=</span><span style="color:#859900;">null</span>)<br>                <span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">                    </span><span style="color:#268bd2;">$str</span><span style="color:#079a71;">=</span><span style="color:#268bd2;">$str</span><span style="color:#079a71;">.</span><span style="color:#2aa198;">'union all select '</span><span style="color:#079a71;">.</span><span style="color:#268bd2;">$lowValues</span><span style="color:#079a71;">.</span><span style="color:#2aa198;">' '</span>;<br>                <span style="color:#dc322f;">}<br></span><span style="color:#dc322f;">                </span><span style="color:#859900;">else<br></span><span style="color:#859900;">                </span><span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">                    </span><span style="color:#268bd2;">$str</span><span style="color:#079a71;">=</span><span style="color:#2aa198;">'select '</span><span style="color:#079a71;">.</span><span style="color:#268bd2;">$lowValues</span><span style="color:#079a71;">.</span><span style="color:#2aa198;">' '</span>;<br>                <span style="color:#dc322f;">}<br></span><span style="color:#dc322f;">            }<br></span><span style="color:#dc322f;">            </span><span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#6c71c4;">_params</span><span style="color:#079a71;">=</span><span style="color:#268bd2;">$tempValue</span>;<br>            <span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#6c71c4;">_sql </span><span style="color:#079a71;">=</span><span style="color:#2aa198;">'INSERT'</span><span style="color:#079a71;">.</span><span style="color:#2aa198;">' INTO '</span><span style="color:#079a71;">.</span><span style="color:#839496;">$table </span><span style="color:#079a71;">. </span><span style="color:#2aa198;">'(' </span><span style="color:#079a71;">. </span><span style="color:#839496;">implode</span>(<span style="color:#2aa198;">','</span>, <span style="color:#268bd2;">$lowNames</span>) <span style="color:#079a71;">. </span><span style="color:#2aa198;">') '</span><span style="color:#079a71;">.</span><span style="color:#268bd2;">$str</span>;<br>        <span style="color:#dc322f;">}<br></span><span style="color:#dc322f;">        </span><span style="color:#859900;">else<br></span><span style="color:#859900;">        </span><span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">            </span><span style="color:#268bd2;">$lowNames  </span><span style="color:#079a71;">= </span><span style="color:#839496;">array_keys</span>( <span style="color:#839496;">$fields</span>);<br>            <span style="color:#268bd2;">$temp</span><span style="color:#079a71;">=</span><span style="color:#859900;">array</span>();<br>            <span style="color:#859900;">foreach </span>(<span style="color:#839496;">$fields </span><span style="color:#859900;">as </span><span style="color:#268bd2;">$item</span><span style="color:#079a71;">=&gt;</span><span style="color:#268bd2;">$value</span>)<br>            <span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">                 </span><span style="color:#268bd2;">$temp[]</span><span style="color:#079a71;">=</span><span style="color:#2aa198;">':'</span><span style="color:#079a71;">.</span><span style="color:#268bd2;">$item</span>;<br>                 <span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#6c71c4;">_params</span><span style="color:#268bd2;">[</span><span style="color:#2aa198;">':'</span><span style="color:#079a71;">.</span><span style="color:#268bd2;">$item]</span><span style="color:#079a71;">=</span><span style="color:#268bd2;">$value</span>;<br>            <span style="color:#dc322f;">}<br></span><span style="color:#dc322f;">            </span><span style="color:#268bd2;">$lowValues</span><span style="color:#079a71;">=</span><span style="color:#839496;">implode</span>(<span style="color:#2aa198;">','</span>,<span style="color:#268bd2;">$temp</span>);<br>            <span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#6c71c4;">_sql </span><span style="color:#079a71;">= </span><span style="color:#2aa198;">'INSERT'</span><span style="color:#079a71;">.</span><span style="color:#2aa198;">' INTO ' </span><span style="color:#079a71;">.</span><span style="color:#839496;">$table </span><span style="color:#079a71;">. </span><span style="color:#2aa198;">'(' </span><span style="color:#079a71;">. </span><span style="color:#839496;">implode</span>( <span style="color:#2aa198;">','</span>, <span style="color:#268bd2;">$lowNames </span>) <span style="color:#079a71;">. </span><span style="color:#2aa198;">') VALUES(' </span><span style="color:#079a71;">. </span><span style="color:#268bd2;">$lowValues </span><span style="color:#079a71;">. </span><span style="color:#2aa198;">')'</span>;<br>        <span style="color:#dc322f;">}<br></span><span style="color:#dc322f;">        </span><span style="color:#859900;">return </span><span style="color:#268bd2;">$this</span>;<br>    <span style="color:#dc322f;">}<br></span><span style="color:#dc322f;">    </span><span style="color:#859900;">public function </span><span style="color:#839496;">lastId</span>()<br>    <span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">        </span><span style="color:#859900;">if </span>(<span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#839496;">execute</span>())<br>        <span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">            </span><span style="color:#859900;">return </span><span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#6c71c4;">_pdo</span><span style="color:#079a71;">-&gt;</span><span style="color:#839496;">lastInsertId</span>();<br>        <span style="color:#dc322f;">}<br></span><span style="color:#dc322f;">        </span><span style="color:#859900;">else<br></span><span style="color:#859900;">        </span><span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">            </span><span style="color:#859900;">return false</span>;<br>        <span style="color:#dc322f;">}<br></span><span style="color:#dc322f;">    }<br></span><span style="color:#dc322f;">    </span><span style="color:#859900;">public function </span><span style="color:#839496;">update</span>(<span style="color:#839496;">string $table</span>,<span style="color:#859900;">array </span><span style="color:#839496;">$fields</span>)<br>    <span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">        </span><span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#6c71c4;">_sql</span><span style="color:#079a71;">=</span><span style="color:#859900;">null</span>;<br>        <span style="color:#268bd2;">$arr</span><span style="color:#079a71;">=</span><span style="color:#859900;">null</span>;<br>        <span style="color:#859900;">foreach </span>(<span style="color:#839496;">$fields </span><span style="color:#859900;">as </span><span style="color:#268bd2;">$item</span><span style="color:#079a71;">=&gt;</span><span style="color:#268bd2;">$value</span>)<br>        <span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">            </span><span style="color:#268bd2;">$arr[]</span><span style="color:#079a71;">=</span><span style="color:#268bd2;">$item</span><span style="color:#079a71;">.</span><span style="color:#2aa198;">'='</span><span style="color:#079a71;">.</span><span style="color:#2aa198;">':'</span><span style="color:#079a71;">.</span><span style="color:#268bd2;">$item</span><span style="color:#079a71;">.</span><span style="color:#2aa198;">' '</span>;<br>            <span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#6c71c4;">_params</span><span style="color:#268bd2;">[</span><span style="color:#2aa198;">':'</span><span style="color:#079a71;">.</span><span style="color:#268bd2;">$item]</span><span style="color:#079a71;">=</span><span style="color:#268bd2;">$value</span>;<br>        <span style="color:#dc322f;">}<br></span><span style="color:#dc322f;">        </span><span style="color:#268bd2;">$str</span><span style="color:#079a71;">=</span><span style="color:#839496;">implode</span>(<span style="color:#2aa198;">','</span>,<span style="color:#268bd2;">$arr</span>);<br>        <span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#6c71c4;">_sql </span><span style="color:#079a71;">= </span><span style="color:#2aa198;">'UPDATE ' </span><span style="color:#079a71;">.</span><span style="color:#839496;">$table </span><span style="color:#079a71;">. </span><span style="color:#2aa198;">' SET '</span><span style="color:#079a71;">.</span><span style="color:#268bd2;">$str</span>;<br>        <span style="color:#859900;">return </span><span style="color:#268bd2;">$this</span>;<br>    <span style="color:#dc322f;">}<br></span><span style="color:#dc322f;">    </span><span style="color:#859900;">function </span><span style="color:#839496;">affectedRows</span>()<br>    <span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">        </span><span style="color:#859900;">if </span>(<span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#839496;">execute</span>())<br>        <span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">            </span><span style="color:#859900;">return </span><span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#6c71c4;">_stmt</span><span style="color:#079a71;">-&gt;</span><span style="color:#839496;">rowCount</span>();<br>        <span style="color:#dc322f;">}<br></span><span style="color:#dc322f;">        </span><span style="color:#859900;">else<br></span><span style="color:#859900;">        </span><span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">            </span><span style="color:#859900;">return false</span>;<br>        <span style="color:#dc322f;">}<br></span><span style="color:#dc322f;">    }<br></span><span style="color:#dc322f;">    </span><span style="color:#859900;">function </span><span style="color:#839496;">delete</span>(<span style="color:#839496;">string $table</span>)<br>    <span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">        </span><span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#6c71c4;">_sql</span><span style="color:#079a71;">=</span><span style="color:#859900;">null</span>;<br>        <span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#6c71c4;">_sql </span><span style="color:#079a71;">= </span><span style="color:#2aa198;">'DELETE'</span><span style="color:#079a71;">.</span><span style="color:#2aa198;">' FROM ' </span><span style="color:#079a71;">. </span><span style="color:#839496;">$table </span><span style="color:#079a71;">. </span><span style="color:#2aa198;">' '</span>;<br>        <span style="color:#859900;">return </span><span style="color:#268bd2;">$this</span>;<br>    <span style="color:#dc322f;">}<br></span><span style="color:#dc322f;">    </span><span style="color:#859900;">public function </span><span style="color:#839496;">startTrans</span>()<br>    <span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">        </span><span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#6c71c4;">_pdo</span><span style="color:#079a71;">-&gt;</span><span style="color:#839496;">beginTransaction</span>();<br>    <span style="color:#dc322f;">}<br></span><span style="color:#dc322f;">    </span><span style="color:#859900;">public function </span><span style="color:#839496;">commitTrans</span>()<br>    <span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">        </span><span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#6c71c4;">_pdo</span><span style="color:#079a71;">-&gt;</span><span style="color:#839496;">commit</span>();<br>    <span style="color:#dc322f;">}<br></span><span style="color:#dc322f;"><br></span><span style="color:#dc322f;">    </span><span style="color:#859900;">public function </span><span style="color:#839496;">inTrans</span>(<span style="color:#839496;">$sql</span>,<span style="color:#839496;">$bindParams</span>)<br>    <span style="color:#dc322f;">{<br></span><span style="color:#dc322f;"><br></span><span style="color:#dc322f;">        </span><span style="color:#859900;">if </span>(<span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#6c71c4;">_pdo</span><span style="color:#079a71;">-&gt;</span><span style="color:#839496;">inTransaction</span>())<br>        <span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">            </span><span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#839496;">doSql</span>(<span style="color:#839496;">$sql</span>,<span style="color:#839496;">$bindParams</span>,<span style="color:#268bd2;">$debug</span><span style="color:#079a71;">=</span><span style="color:#859900;">false</span>);<br>        <span style="color:#dc322f;">}<br></span><span style="color:#dc322f;">        </span><span style="color:#859900;">else<br></span><span style="color:#859900;">        </span><span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">            </span><span style="color:#839496;">GetError</span>(<span style="color:#2aa198;">'</span><span style="color:#2aa198;font-family:'Courier New';">没有开启事务</span><span style="color:#2aa198;">'</span>);<br>        <span style="color:#dc322f;">}<br></span><span style="color:#dc322f;">    }<br></span><span style="color:#dc322f;">    </span><span style="color:#859900;">public function </span><span style="color:#839496;">rollBackTrans</span>()<br>    <span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">        </span><span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#6c71c4;">_pdo</span><span style="color:#079a71;">-&gt;</span><span style="color:#839496;">rollBack</span>();<br>    <span style="color:#dc322f;">}<br></span><span style="color:#dc322f;">    </span><span style="color:#859900;">public function </span><span style="color:#839496;">debug</span>()<br>    <span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">        </span><span style="color:#859900;">die</span>(<span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#6c71c4;">_sql</span>);<br>    <span style="color:#dc322f;">}<br></span><span style="color:#dc322f;">    </span><span style="color:#859900;">public function </span><span style="color:#839496;">close</span>()<br>    <span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">        </span><span style="color:#268bd2;">$this</span><span style="color:#079a71;">-&gt;</span><span style="color:#6c71c4;">_pdo </span><span style="color:#079a71;">= </span><span style="color:#859900;">null</span>;<br>    <span style="color:#dc322f;">}<br></span><span style="color:#dc322f;"><br></span><span style="color:#dc322f;">}</span></pre>