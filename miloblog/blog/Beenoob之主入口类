<pre style="background-color:#fdf6e3;color:#586e75;font-family:'Source Code Pro';font-size:13.5pt;"><span style="color:#dc322f;">&lt;?php<br></span><span style="color:#859900;">namespace </span><span style="color:#839496;">Core</span>;<br><span style="color:#859900;">use </span><span style="color:#839496;">Core</span>\<span style="color:#839496;">Libs</span>\<span style="color:#839496;">Route</span>;<br><span style="color:#859900;">class </span><span style="color:#b58900;">MiloCore<br></span><span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">    </span><span style="color:#859900;">private function </span><span style="color:#839496;">__construct</span>()<br>    <span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">    }<br></span><span style="color:#dc322f;">    </span><span style="color:#859900;">private function </span><span style="color:#839496;">__clone</span>()<br>    <span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">    }<br></span><span style="color:#dc322f;"><br></span><span style="color:#dc322f;">    </span><span style="color:#93a1a1;font-style:italic;">/**<br></span><span style="color:#93a1a1;font-style:italic;">     * </span><span style="color:#93a1a1;font-style:italic;font-family:'Courier New';">初始化并检测相关的环境<br></span><span style="color:#93a1a1;font-style:italic;font-family:'Courier New';">     </span><span style="color:#93a1a1;font-style:italic;">*/<br></span><span style="color:#93a1a1;font-style:italic;">    </span><span style="color:#859900;">private static function </span><span style="color:#839496;">_init</span>()<br>    <span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">        </span><span style="color:#859900;">if</span>(<span style="color:#839496;">version_compare</span>(<span style="color:#d33682;">PHP_VERSION</span>,<span style="color:#2aa198;">'7.0.0'</span>,<span style="color:#2aa198;">'&lt;'</span>))<span style="color:#859900;">die</span>(<span style="color:#2aa198;">'require PHP &gt; 7.0.0 !'</span>);<br>        <span style="color:#d33682;">DEBUG</span><span style="color:#079a71;">?</span><span style="color:#839496;">ini_set</span>(<span style="color:#2aa198;">'display_errors'</span>,<span style="color:#2aa198;">'On'</span>)<span style="color:#079a71;">:</span><span style="color:#839496;">ini_set</span>(<span style="color:#2aa198;">'display_errors'</span>,<span style="color:#2aa198;">'Off'</span>);<br>        <span style="color:#839496;">session_start</span>();<br>        <span style="color:#859900;">self</span><span style="color:#079a71;">::</span><span style="color:#969483;">_define</span>();<br>        <span style="color:#859900;">self</span><span style="color:#079a71;">::</span><span style="color:#969483;">_sld</span>();<br>        <span style="color:#859900;">self</span><span style="color:#079a71;">::</span><span style="color:#969483;">_path</span>();<br>        <span style="color:#859900;">require </span><span style="color:#d33682;">CORE_PATH</span><span style="color:#079a71;">.</span><span style="color:#2aa198;">'Common/Function.php'</span><span style="color:#079a71;">.</span><span style="color:#2aa198;">''</span>;<br>        <span style="color:#859900;">require </span><span style="color:#d33682;">CORE_PATH</span><span style="color:#079a71;">.</span><span style="color:#2aa198;">'Common/Common.php'</span><span style="color:#079a71;">.</span><span style="color:#2aa198;">''</span>;<br>        <span style="color:#859900;">if</span>(<span style="color:#d33682;">MEMORY_LIMIT_ON</span>)<br>        <span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">            </span><span style="color:#268bd2;">$GLOBALS[</span><span style="color:#2aa198;">'StartUseMemory'</span><span style="color:#268bd2;">] </span><span style="color:#079a71;">= </span><span style="color:#839496;">memory_get_usage</span>();<br>        <span style="color:#dc322f;">}<br></span><span style="color:#dc322f;">        </span><span style="color:#859900;">if</span>(<span style="color:#079a71;">!</span><span style="color:#839496;">is_dir</span>(<span style="color:#d33682;">WEB_PATH</span>))<br>        <span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">            </span><span style="color:#839496;">mkdir</span>(<span style="color:#d33682;">WEB_PATH</span>, <span style="color:#2aa198;">0777</span>, <span style="color:#859900;">true</span>);<br>            <span style="color:#839496;">mkdir</span>(<span style="color:#d33682;">WEB_PATH</span><span style="color:#079a71;">.</span><span style="color:#2aa198;">'/Model'</span>, <span style="color:#2aa198;">0777</span>, <span style="color:#859900;">true</span>);<br>            <span style="color:#839496;">mkdir</span>(<span style="color:#d33682;">WEB_PATH</span><span style="color:#079a71;">.</span><span style="color:#2aa198;">'/View'</span>, <span style="color:#2aa198;">0777</span>, <span style="color:#859900;">true</span>);<br>            <span style="color:#839496;">mkdir</span>(<span style="color:#d33682;">WEB_PATH</span><span style="color:#079a71;">.</span><span style="color:#2aa198;">'/View'</span><span style="color:#079a71;">.</span><span style="color:#2aa198;">'/Cache'</span>, <span style="color:#2aa198;">0777</span>, <span style="color:#859900;">true</span>);<br>            <span style="color:#839496;">mkdir</span>(<span style="color:#d33682;">WEB_PATH</span><span style="color:#079a71;">.</span><span style="color:#2aa198;">'/View'</span><span style="color:#079a71;">.</span><span style="color:#2aa198;">'/Cache/PHP/'</span>, <span style="color:#2aa198;">0777</span>, <span style="color:#859900;">true</span>);<br>            <span style="color:#839496;">mkdir</span>(<span style="color:#d33682;">WEB_PATH</span><span style="color:#079a71;">.</span><span style="color:#2aa198;">'/View'</span><span style="color:#079a71;">.</span><span style="color:#2aa198;">'/Cache/HTML/'</span>, <span style="color:#2aa198;">0777</span>, <span style="color:#859900;">true</span>);<br>            <span style="color:#839496;">mkdir</span>(<span style="color:#d33682;">WEB_PATH</span><span style="color:#079a71;">.</span><span style="color:#2aa198;">'/View'</span><span style="color:#079a71;">.</span><span style="color:#2aa198;">'/Templates'</span>, <span style="color:#2aa198;">0777</span>, <span style="color:#859900;">true</span>);<br>            <span style="color:#839496;">file_put_contents</span>(<span style="color:#d33682;">WEB_PATH</span><span style="color:#079a71;">.</span><span style="color:#2aa198;">'/View'</span><span style="color:#079a71;">.</span><span style="color:#2aa198;">'/Templates'</span><span style="color:#079a71;">.</span><span style="color:#2aa198;">'/'</span><span style="color:#079a71;">.</span><span style="color:#2aa198;">'index.html'</span>,<span style="color:#839496;">file_get_contents</span>(<span style="color:#d33682;">CORE_PATH</span><span style="color:#079a71;">.</span><span style="color:#2aa198;">'/'</span><span style="color:#079a71;">.</span><span style="color:#2aa198;">'index.html'</span>));<br>            <span style="color:#839496;">mkdir</span>(<span style="color:#d33682;">WEB_PATH</span><span style="color:#079a71;">.</span><span style="color:#2aa198;">'/Controller'</span>, <span style="color:#2aa198;">0777</span>, <span style="color:#859900;">true</span>);<br>            <span style="color:#839496;">mkdir</span>(<span style="color:#d33682;">WEB_PATH</span><span style="color:#079a71;">.</span><span style="color:#2aa198;">'/Public/Upload/Image'</span>, <span style="color:#2aa198;">0777</span>, <span style="color:#859900;">true</span>);<br>            <span style="color:#839496;">mkdir</span>(<span style="color:#d33682;">WEB_PATH</span><span style="color:#079a71;">.</span><span style="color:#2aa198;">'/Public/Upload/Text'</span>, <span style="color:#2aa198;">0777</span>, <span style="color:#859900;">true</span>);<br>            <span style="color:#839496;">mkdir</span>(<span style="color:#d33682;">WEB_PATH</span><span style="color:#079a71;">.</span><span style="color:#2aa198;">'/Public/Static/JS'</span>, <span style="color:#2aa198;">0777</span>, <span style="color:#859900;">true</span>);<br>            <span style="color:#839496;">mkdir</span>(<span style="color:#d33682;">WEB_PATH</span><span style="color:#079a71;">.</span><span style="color:#2aa198;">'/Public/Static/CSS'</span>, <span style="color:#2aa198;">0777</span>, <span style="color:#859900;">true</span>);<br>            <span style="color:#839496;">mkdir</span>(<span style="color:#d33682;">WEB_PATH</span><span style="color:#079a71;">.</span><span style="color:#2aa198;">'/Public/Static/Images'</span>, <span style="color:#2aa198;">0777</span>, <span style="color:#859900;">true</span>);<br>            <span style="color:#268bd2;">$string</span><span style="color:#079a71;">=</span><span style="color:#2aa198;">'&lt;?php'</span><span style="color:#079a71;">.</span><span style="color:#d33682;">PHP_EOL</span><span style="color:#079a71;">.</span><span style="color:#2aa198;">'namespace '</span><span style="color:#079a71;">.</span><span style="color:#d33682;">WEB_NAME</span><span style="color:#079a71;">.</span><span style="color:#2aa198;">'</span><span style="color:#d33682;font-weight:bold;">\\</span><span style="color:#2aa198;">Controller;'</span><span style="color:#079a71;">.</span><span style="color:#d33682;">PHP_EOL</span><span style="color:#079a71;">.</span><span style="color:#2aa198;">'use Core\Libs\BaseController;'</span><span style="color:#079a71;">.</span><span style="color:#d33682;">PHP_EOL<br></span><span style="color:#d33682;">            </span><span style="color:#079a71;">.</span><span style="color:#2aa198;">'class IndexController extends BaseController'</span><span style="color:#079a71;">.</span><span style="color:#d33682;">PHP_EOL</span><span style="color:#079a71;">.</span><span style="color:#2aa198;">'{'</span><span style="color:#079a71;">.</span><span style="color:#d33682;">PHP_EOL</span><span style="color:#079a71;">.</span><span style="color:#2aa198;">'   public function index()'</span><span style="color:#079a71;">.</span><span style="color:#d33682;">PHP_EOL</span><span style="color:#079a71;">.<br></span><span style="color:#079a71;">            </span><span style="color:#2aa198;">'   {'</span><span style="color:#079a71;">.</span><span style="color:#d33682;">PHP_EOL</span><span style="color:#079a71;">.</span><span style="color:#2aa198;">'      $this-&gt;display(</span><span style="color:#d33682;font-weight:bold;">\'</span><span style="color:#2aa198;">index.html</span><span style="color:#d33682;font-weight:bold;">\'</span><span style="color:#2aa198;">);'</span><span style="color:#079a71;">.</span><span style="color:#d33682;">PHP_EOL</span><span style="color:#079a71;">.</span><span style="color:#2aa198;">'   }'</span><span style="color:#079a71;">.</span><span style="color:#d33682;">PHP_EOL</span><span style="color:#079a71;">.</span><span style="color:#2aa198;">'}'</span>;<br>            <span style="color:#839496;">file_put_contents</span>(<span style="color:#d33682;">WEB_PATH</span><span style="color:#079a71;">.</span><span style="color:#2aa198;">'Controller'</span><span style="color:#079a71;">.</span><span style="color:#2aa198;">'/'</span><span style="color:#079a71;">.</span><span style="color:#2aa198;">'IndexController.class.php'</span>,<span style="color:#268bd2;">$string</span>);<br>            <span style="color:#839496;">mkdir</span>(<span style="color:#d33682;">WEB_PATH</span><span style="color:#079a71;">.</span><span style="color:#2aa198;">'Common'</span>, <span style="color:#2aa198;">0777</span>, <span style="color:#859900;">true</span>);<br>            <span style="color:#839496;">mkdir</span>(<span style="color:#d33682;">WEB_PATH</span><span style="color:#079a71;">.</span><span style="color:#2aa198;">'Common'</span><span style="color:#079a71;">.</span><span style="color:#2aa198;">'/Config'</span>, <span style="color:#2aa198;">0777</span>, <span style="color:#859900;">true</span>);<br>            <span style="color:#839496;">mkdir</span>(<span style="color:#d33682;">WEB_PATH</span><span style="color:#079a71;">.</span><span style="color:#2aa198;">'Common'</span><span style="color:#079a71;">.</span><span style="color:#2aa198;">'/Log'</span>, <span style="color:#2aa198;">0777</span>, <span style="color:#859900;">true</span>);<br>            <span style="color:#839496;">file_put_contents</span>(<span style="color:#d33682;">WEB_PATH</span><span style="color:#079a71;">.</span><span style="color:#2aa198;">'Common/Config/Config.php'</span>,<span style="color:#839496;">file_get_contents</span>(<span style="color:#d33682;">CORE_PATH</span><span style="color:#079a71;">.</span><span style="color:#2aa198;">'Common/Config/Config.php'</span>));<br>        <span style="color:#dc322f;">}<br></span><span style="color:#dc322f;">    }<br></span><span style="color:#dc322f;"><br></span><span style="color:#dc322f;">    </span><span style="color:#93a1a1;font-style:italic;">/**<br></span><span style="color:#93a1a1;font-style:italic;">     * </span><span style="color:#93a1a1;font-style:italic;font-family:'Courier New';">唯一入口<br></span><span style="color:#93a1a1;font-style:italic;font-family:'Courier New';">     </span><span style="color:#93a1a1;font-style:italic;">*/<br></span><span style="color:#93a1a1;font-style:italic;">    </span><span style="color:#859900;">public static function </span><span style="color:#839496;">run</span>()<br>    <span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">        </span><span style="color:#859900;">self</span><span style="color:#079a71;">::</span><span style="color:#969483;">_init</span>();<br>        <span style="color:#859900;">self</span><span style="color:#079a71;">::</span><span style="color:#969483;">_autoload</span>();<br>        <span style="color:#859900;">self</span><span style="color:#079a71;">::</span><span style="color:#969483;">_loadVendor</span>();<br>        <span style="color:#268bd2;">$route </span><span style="color:#079a71;">= </span><span style="color:#b58900;">Route</span><span style="color:#079a71;">::</span><span style="color:#969483;">getInstance</span>();<br>        <span style="color:#268bd2;">$control</span><span style="color:#079a71;">=</span><span style="color:#268bd2;">$route</span><span style="color:#079a71;">-&gt;</span><span style="color:#839496;">getControl</span>();<br>        <span style="color:#268bd2;">$action</span><span style="color:#079a71;">=</span><span style="color:#268bd2;">$route</span><span style="color:#079a71;">-&gt;</span><span style="color:#839496;">getAction</span>();<br>        <span style="color:#268bd2;">$CtrlFile</span><span style="color:#079a71;">=</span><span style="color:#d33682;">WEB_PATH</span><span style="color:#079a71;">.</span><span style="color:#2aa198;">'controller/'</span><span style="color:#079a71;">.</span><span style="color:#268bd2;">$control</span><span style="color:#079a71;">.</span><span style="color:#2aa198;">'Controller'</span><span style="color:#079a71;">.</span><span style="color:#d33682;">EXT</span>;<br>        <span style="color:#268bd2;">$CtrlClass</span><span style="color:#079a71;">=</span><span style="color:#839496;">trim</span>(<span style="color:#839496;">ltrim</span>(<span style="color:#d33682;">WEB_PATH</span>,<span style="color:#d33682;">ROOT_DIR</span>),<span style="color:#2aa198;">'/'</span>)<span style="color:#079a71;">.</span><span style="color:#2aa198;">'\Controller</span><span style="color:#d33682;font-weight:bold;">\\</span><span style="color:#2aa198;">'</span><span style="color:#079a71;">.</span><span style="color:#268bd2;">$control</span><span style="color:#079a71;">.</span><span style="color:#2aa198;">'Controller'</span>;<br>        <span style="color:#859900;">if </span>(<span style="color:#839496;">is_file</span>(<span style="color:#268bd2;">$CtrlFile</span>))<br>        <span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">            </span><span style="color:#268bd2;">$ctrl </span><span style="color:#079a71;">= </span><span style="color:#859900;">new </span><span style="color:#268bd2;">$CtrlClass</span>();<br>            <span style="color:#859900;">if </span>(<span style="color:#839496;">method_exists</span>(<span style="color:#268bd2;">$ctrl</span>,<span style="color:#268bd2;">$action</span>))<br>            <span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">                </span><span style="color:#268bd2;">$ctrl</span><span style="color:#079a71;">-&gt;</span><span style="color:#268bd2;">$action</span>();<br>            <span style="color:#dc322f;">}<br></span><span style="color:#dc322f;">            </span><span style="color:#859900;">else<br></span><span style="color:#859900;">            </span><span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">                </span><span style="color:#839496;">GetError</span>(<span style="color:#268bd2;">$action</span><span style="color:#079a71;">.</span><span style="color:#2aa198;">' </span><span style="color:#2aa198;font-family:'Courier New';">方法不存在</span><span style="color:#2aa198;">'</span>);<br>            <span style="color:#dc322f;">}<br></span><span style="color:#dc322f;">        }<br></span><span style="color:#dc322f;">        </span><span style="color:#859900;">else<br></span><span style="color:#859900;">        </span><span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">            </span><span style="color:#839496;">GetError</span>(<span style="color:#268bd2;">$control</span><span style="color:#079a71;">.</span><span style="color:#2aa198;">' </span><span style="color:#2aa198;font-family:'Courier New';">控制器不存在</span><span style="color:#2aa198;">'</span>);<br>        <span style="color:#dc322f;">}<br></span><span style="color:#dc322f;">    }<br></span><span style="color:#dc322f;">    </span><span style="color:#93a1a1;font-style:italic;">/**<br></span><span style="color:#93a1a1;font-style:italic;">     * </span><span style="color:#93a1a1;font-style:italic;font-family:'Courier New';">自动加载第三方库<br></span><span style="color:#93a1a1;font-style:italic;font-family:'Courier New';">     </span><span style="color:#93a1a1;font-style:italic;">*/<br></span><span style="color:#93a1a1;font-style:italic;">    </span><span style="color:#859900;">private static function </span><span style="color:#839496;">_loadVendor</span>()<br>    <span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">        </span><span style="color:#859900;">if </span>(<span style="color:#839496;">file_exists</span>(<span style="color:#2aa198;">'Vendor/autoload.php'</span>))<br>        <span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">            </span><span style="color:#859900;">require_once </span><span style="color:#2aa198;">"Vendor/autoload.php"</span>;<br>        <span style="color:#dc322f;">}<br></span><span style="color:#dc322f;">    }<br></span><span style="color:#dc322f;">    </span><span style="color:#93a1a1;font-style:italic;">/**<br></span><span style="color:#93a1a1;font-style:italic;">     * </span><span style="color:#93a1a1;font-style:italic;font-family:'Courier New';">自动加载类库<br></span><span style="color:#93a1a1;font-style:italic;font-family:'Courier New';">     </span><span style="color:#93a1a1;font-style:italic;">*/<br></span><span style="color:#93a1a1;font-style:italic;">    </span><span style="color:#859900;">private static function </span><span style="color:#839496;">_autoload</span>()<br>    <span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">        </span><span style="color:#839496;">spl_autoload_extensions</span>(<span style="color:#2aa198;">'.class.php'</span>);<br>        <span style="color:#839496;">set_include_path</span>(<span style="color:#839496;">get_include_path</span>()<span style="color:#079a71;">.</span><span style="color:#d33682;">PATH_SEPARATOR</span><span style="color:#079a71;">.</span><span style="color:#2aa198;">''</span>);<br>        <span style="color:#839496;">spl_autoload_register</span>();<br>    <span style="color:#dc322f;">}<br></span><span style="color:#dc322f;"><br></span><span style="color:#dc322f;">    </span><span style="color:#93a1a1;font-style:italic;">/**<br></span><span style="color:#93a1a1;font-style:italic;">     * </span><span style="color:#93a1a1;font-style:italic;font-family:'Courier New';">定义一些系统常量<br></span><span style="color:#93a1a1;font-style:italic;font-family:'Courier New';">     </span><span style="color:#93a1a1;font-style:italic;">*/<br></span><span style="color:#93a1a1;font-style:italic;">    </span><span style="color:#859900;">private static function </span><span style="color:#839496;">_define</span>()<br>    <span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">        </span><span style="color:#839496;">date_default_timezone_set</span>(<span style="color:#2aa198;">'Asia/Chongqing'</span>);<br>        <span style="color:#268bd2;">$GLOBALS[</span><span style="color:#2aa198;">'StartTime'</span><span style="color:#268bd2;">] </span><span style="color:#079a71;">= </span><span style="color:#839496;">microtime</span>(<span style="color:#859900;">TRUE</span>);<br>        <span style="color:#839496;">define</span>(<span style="color:#2aa198;">'MEMORY_LIMIT_ON'</span>,<span style="color:#839496;">function_exists</span>(<span style="color:#2aa198;">'memory_get_usage'</span>));<br>        <span style="color:#839496;">defined</span>(<span style="color:#2aa198;">'ROOT_DIR'</span>) <span style="color:#859900;">or </span><span style="color:#839496;">define</span>(<span style="color:#2aa198;">'ROOT_DIR'</span>,<span style="color:#839496;">str_replace</span>(<span style="color:#2aa198;">'</span><span style="color:#d33682;font-weight:bold;">\\</span><span style="color:#2aa198;">'</span>,<span style="color:#2aa198;">'/'</span>,<span style="color:#839496;">getcwd</span>()));<br>        <span style="color:#839496;">defined</span>(<span style="color:#2aa198;">'APP_NAME'</span>) <span style="color:#859900;">or </span><span style="color:#839496;">define</span>(<span style="color:#2aa198;">'APP_NAME'</span>,<span style="color:#2aa198;">'Home'</span>);<br>        <span style="color:#839496;">defined</span>(<span style="color:#2aa198;">'APP_PATH'</span>) <span style="color:#859900;">or </span><span style="color:#839496;">define</span>(<span style="color:#2aa198;">'APP_PATH'</span>,<span style="color:#d33682;">ROOT_DIR</span><span style="color:#079a71;">.</span><span style="color:#2aa198;">'/'</span><span style="color:#079a71;">.</span><span style="color:#d33682;">APP_NAME</span><span style="color:#079a71;">.</span><span style="color:#2aa198;">'/'</span>);<br>        <span style="color:#839496;">defined</span>(<span style="color:#2aa198;">'DEBUG'</span>) <span style="color:#859900;">or </span><span style="color:#839496;">define</span>(<span style="color:#2aa198;">'DEBUG'</span>,<span style="color:#859900;">false</span>);<br>        <span style="color:#839496;">defined</span>(<span style="color:#2aa198;">'URL_SECRET'</span>) <span style="color:#859900;">or </span><span style="color:#839496;">define</span>(<span style="color:#2aa198;">'URL_SECRET'</span>,<span style="color:#859900;">false</span>);<br>        <span style="color:#839496;">defined</span>(<span style="color:#2aa198;">'PUBLIC'</span>) <span style="color:#859900;">or </span><span style="color:#839496;">define</span>(<span style="color:#2aa198;">'PUBLIC'</span>,<span style="color:#d33682;">ROOT_DIR</span><span style="color:#079a71;">.</span><span style="color:#2aa198;">'/Public/'</span>);<br>        <span style="color:#839496;">defined</span>(<span style="color:#2aa198;">'VENDOR'</span>) <span style="color:#859900;">or </span><span style="color:#839496;">define</span>(<span style="color:#2aa198;">'VENDOR'</span>,<span style="color:#d33682;">ROOT_DIR</span><span style="color:#079a71;">.</span><span style="color:#2aa198;">'/Vendor/'</span>);<br>        <span style="color:#839496;">defined</span>(<span style="color:#2aa198;">'EXT'</span>) <span style="color:#859900;">or </span><span style="color:#839496;">define</span>(<span style="color:#2aa198;">'EXT'</span>,<span style="color:#2aa198;">'.class.php'</span>);<br>        <span style="color:#839496;">defined</span>(<span style="color:#2aa198;">'CACHE_DB_M'</span>) <span style="color:#859900;">or </span><span style="color:#839496;">define</span>(<span style="color:#2aa198;">'CACHE_DB_M'</span>,<span style="color:#859900;">false</span>);<br>        <span style="color:#839496;">defined</span>(<span style="color:#2aa198;">'CACHE_DB_R'</span>) <span style="color:#859900;">or </span><span style="color:#839496;">define</span>(<span style="color:#2aa198;">'CACHE_DB_R'</span>,<span style="color:#859900;">false</span>);<br>        <span style="color:#839496;">defined</span>(<span style="color:#2aa198;">'CACHE_PHP'</span>) <span style="color:#859900;">or </span><span style="color:#839496;">define</span>(<span style="color:#2aa198;">'CACHE_PHP'</span>,<span style="color:#859900;">false</span>);<br>        <span style="color:#839496;">defined</span>(<span style="color:#2aa198;">'CACHE_HTML'</span>) <span style="color:#859900;">or </span><span style="color:#839496;">define</span>(<span style="color:#2aa198;">'CACHE_HTML'</span>,<span style="color:#859900;">false</span>);<br>        <span style="color:#839496;">defined</span>(<span style="color:#2aa198;">'CACHE_TIME'</span>) <span style="color:#859900;">or </span><span style="color:#839496;">define</span>(<span style="color:#2aa198;">'CACHE_TIME'</span>,<span style="color:#2aa198;">200</span>);<br>        <span style="color:#839496;">defined</span>(<span style="color:#2aa198;">'CORE_PATH'</span>) <span style="color:#859900;">or </span><span style="color:#839496;">define</span>(<span style="color:#2aa198;">'CORE_PATH'</span>,<span style="color:#d33682;">ROOT_DIR</span><span style="color:#079a71;">.</span><span style="color:#2aa198;">'/Core/'</span>);<br>        <span style="color:#839496;">define</span>(<span style="color:#2aa198;">'VERSION'</span>,<span style="color:#2aa198;">'1.0.0'</span>);<br>        <span style="color:#839496;">define</span>(<span style="color:#2aa198;">'MAGIC_GPC'</span>,<span style="color:#839496;">ini_get</span>(<span style="color:#2aa198;">'magic_quotes_gpc'</span>)<span style="color:#079a71;">?</span><span style="color:#859900;">true</span><span style="color:#079a71;">:</span><span style="color:#859900;">false</span>);<br>    <span style="color:#dc322f;">}<br></span><span style="color:#dc322f;"><br></span><span style="color:#dc322f;">    </span><span style="color:#93a1a1;font-style:italic;">/**<br></span><span style="color:#93a1a1;font-style:italic;">     * </span><span style="color:#93a1a1;font-style:italic;font-family:'Courier New';">判断是否是二级域名访问<br></span><span style="color:#93a1a1;font-style:italic;font-family:'Courier New';">     </span><span style="color:#93a1a1;font-style:italic;">*/<br></span><span style="color:#93a1a1;font-style:italic;">    </span><span style="color:#859900;">private static function </span><span style="color:#839496;">_path</span>()<br>    <span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">        </span><span style="color:#859900;">if </span>(<span style="color:#d33682;">IS_SLD</span>)<br>        <span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">            </span><span style="color:#839496;">define</span>(<span style="color:#2aa198;">'WEB_PATH'</span>,<span style="color:#d33682;">ROOT_DIR</span><span style="color:#079a71;">.</span><span style="color:#2aa198;">'/'</span><span style="color:#079a71;">.</span><span style="color:#d33682;">SLD</span><span style="color:#079a71;">.</span><span style="color:#2aa198;">'/'</span>);<br>            <span style="color:#839496;">defined</span>(<span style="color:#2aa198;">'WEB_NAME'</span>) <span style="color:#859900;">or </span><span style="color:#839496;">define</span>(<span style="color:#2aa198;">'WEB_NAME'</span>,<span style="color:#d33682;">SLD</span>);<br>        <span style="color:#dc322f;">}<br></span><span style="color:#dc322f;">        </span><span style="color:#859900;">else<br></span><span style="color:#859900;">        </span><span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">            </span><span style="color:#839496;">define</span>(<span style="color:#2aa198;">'WEB_PATH'</span>,<span style="color:#d33682;">APP_PATH</span>);<br>            <span style="color:#839496;">defined</span>(<span style="color:#2aa198;">'WEB_NAME'</span>) <span style="color:#859900;">or </span><span style="color:#839496;">define</span>(<span style="color:#2aa198;">'WEB_NAME'</span>,<span style="color:#d33682;">APP_NAME</span>);<br>        <span style="color:#dc322f;">}<br></span><span style="color:#dc322f;">    }<br></span><span style="color:#dc322f;"><br></span><span style="color:#dc322f;">    </span><span style="color:#93a1a1;font-style:italic;">/**<br></span><span style="color:#93a1a1;font-style:italic;">     * </span><span style="color:#93a1a1;font-style:italic;font-family:'Courier New';">检测是否是二级域名访问<br></span><span style="color:#93a1a1;font-style:italic;font-family:'Courier New';">     </span><span style="color:#93a1a1;font-style:italic;">*/<br></span><span style="color:#93a1a1;font-style:italic;">    </span><span style="color:#859900;">private static function </span><span style="color:#839496;">_sld</span>()<br>    <span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">        </span><span style="color:#268bd2;">$SLD</span><span style="color:#079a71;">=</span><span style="color:#839496;">explode</span>(<span style="color:#2aa198;">'.'</span>,<span style="color:#268bd2;">$_SERVER[</span><span style="color:#2aa198;">'HTTP_HOST'</span><span style="color:#268bd2;">]</span>)<span style="color:#268bd2;">[</span><span style="color:#2aa198;">0</span><span style="color:#268bd2;">]</span>;<br>        <span style="color:#859900;">if</span>(<span style="color:#268bd2;">$SLD</span><span style="color:#079a71;">!=</span><span style="color:#2aa198;">'localhost'</span><span style="color:#079a71;">&amp;&amp;</span><span style="color:#268bd2;">$SLD</span><span style="color:#079a71;">!=</span><span style="color:#2aa198;">'127'</span>)<br>        <span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">            </span><span style="color:#268bd2;">$conf</span><span style="color:#079a71;">=</span><span style="color:#859900;">require_once </span><span style="color:#d33682;">CORE_PATH</span><span style="color:#079a71;">.</span><span style="color:#2aa198;">'Common/Config/SLDConf.php'</span><span style="color:#079a71;">.</span><span style="color:#2aa198;">''</span>;<br>            <span style="color:#859900;">if</span>(<span style="color:#859900;">isset</span>(<span style="color:#268bd2;">$conf</span>)<span style="color:#079a71;">&amp;&amp;</span><span style="color:#268bd2;">$conf</span><span style="color:#079a71;">!=</span><span style="color:#859900;">null</span>)<br>            <span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">                </span><span style="color:#859900;">if </span>(<span style="color:#839496;">is_array</span>(<span style="color:#268bd2;">$conf</span>))<br>                <span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">                    </span><span style="color:#859900;">foreach </span>(<span style="color:#268bd2;">$conf </span><span style="color:#859900;">as </span><span style="color:#268bd2;">$key </span><span style="color:#079a71;">=&gt; </span><span style="color:#268bd2;">$value</span>)<br>                    <span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">                        </span><span style="color:#859900;">if </span>(<span style="color:#839496;">strtolower</span>(<span style="color:#268bd2;">$SLD</span>)<span style="color:#079a71;">==</span><span style="color:#839496;">strtolower</span>(<span style="color:#268bd2;">$value</span>))<br>                        <span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">                            </span><span style="color:#839496;">defined</span>(<span style="color:#2aa198;">'IS_SLD'</span>) <span style="color:#859900;">or </span><span style="color:#839496;">define</span>(<span style="color:#2aa198;">'IS_SLD'</span>,<span style="color:#859900;">true</span>);<br>                            <span style="color:#839496;">defined</span>(<span style="color:#2aa198;">'SLD'</span>) <span style="color:#859900;">or </span><span style="color:#839496;">define</span>(<span style="color:#2aa198;">'SLD'</span>,<span style="color:#268bd2;">$value</span>);<br>                            <span style="color:#859900;">break</span>;<br>                        <span style="color:#dc322f;">}<br></span><span style="color:#dc322f;">                    }<br></span><span style="color:#dc322f;">                }<br></span><span style="color:#dc322f;">            }<br></span><span style="color:#dc322f;">        }<br></span><span style="color:#dc322f;">        </span><span style="color:#839496;">defined</span>(<span style="color:#2aa198;">'IS_SLD'</span>) <span style="color:#859900;">or </span><span style="color:#839496;">define</span>(<span style="color:#2aa198;">'IS_SLD'</span>,<span style="color:#859900;">false</span>);<br>    <span style="color:#dc322f;">}<br></span><span style="color:#dc322f;">}</span></pre>