  
	<pre style="background-color:#fdf6e3;color:#586e75;font-family:'Source Code Pro';font-size:13.5pt;"><span style="color:#859900;">function </span><span style="color:#839496;">all_str_len</span>(<span style="color:#839496;">$str</span>)<br><span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">   </span><span style="color:#268bd2;">$len </span><span style="color:#079a71;">= </span><span style="color:#839496;">strlen</span>(<span style="color:#839496;">$str</span>);<br><br>   <span style="color:#859900;">if </span>(<span style="color:#268bd2;">$len </span><span style="color:#079a71;">&lt;= </span><span style="color:#2aa198;">0</span>)<br>   <span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">      </span><span style="color:#859900;">return </span><span style="color:#2aa198;">0</span>;<br>   <span style="color:#dc322f;">}<br></span><span style="color:#dc322f;">   </span><span style="color:#268bd2;">$a_str_len</span><span style="color:#079a71;">=</span><span style="color:#839496;">strlen</span>(<span style="color:#2aa198;">'</span><span style="color:#2aa198;font-family:'Courier New';">汉</span><span style="color:#2aa198;">'</span>);<br>   <span style="color:#268bd2;">$skip</span><span style="color:#079a71;">=</span><span style="color:#268bd2;">$a_str_len</span><span style="color:#079a71;">-</span><span style="color:#2aa198;">1</span>;<br>   <span style="color:#268bd2;">$count  </span><span style="color:#079a71;">= </span><span style="color:#2aa198;">0</span>;<br><br>   <span style="color:#859900;">for </span>(<span style="color:#268bd2;">$i </span><span style="color:#079a71;">= </span><span style="color:#2aa198;">0</span>; <span style="color:#268bd2;">$i </span><span style="color:#079a71;">&lt; </span><span style="color:#268bd2;">$len</span>; <span style="color:#268bd2;">$i</span><span style="color:#079a71;">++</span>)<br>   <span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">      </span><span style="color:#859900;">echo </span><span style="color:#268bd2;">$i</span><span style="color:#079a71;">.</span><span style="color:#2aa198;">'&lt;br&gt;'</span>;<br>      <span style="color:#268bd2;">$count</span><span style="color:#079a71;">++</span>;<br>      <span style="color:#859900;">if </span>(<span style="color:#839496;">ord</span>(<span style="color:#839496;">$str</span><span style="color:#dc322f;">{</span><span style="color:#268bd2;">$i</span><span style="color:#dc322f;">}</span>) <span style="color:#079a71;">&gt;= </span><span style="color:#2aa198;">0x80</span>)<br>      <span style="color:#dc322f;">{<br></span><span style="color:#dc322f;">         </span><span style="color:#268bd2;">$i </span><span style="color:#079a71;">+= </span><span style="color:#268bd2;">$skip</span>;<br>      <span style="color:#dc322f;">}<br></span><span style="color:#dc322f;">   }<br></span><span style="color:#dc322f;">   </span><span style="color:#859900;">return </span><span style="color:#268bd2;">$count</span>;<br><span style="color:#dc322f;">}<br></span><span style="color:#dc322f;"><br></span><span style="color:#859900;">echo </span><span style="color:#2aa198;">"字符串自然长度为: " </span><span style="color:#079a71;">. </span><span style="color:#839496;">all_str_len</span>(<span style="color:#2aa198;">"</span><span style="color:#2aa198;font-family:'Courier New';">测试#A字符串!@#oo0的长度</span><span style="color:#2aa198;">"</span>) <span style="color:#079a71;">. </span><span style="color:#2aa198;">"</span><span style="color:#d33682;font-weight:bold;">\n</span><span style="color:#2aa198;">"</span>;</pre>